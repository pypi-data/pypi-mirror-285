(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[80833],{501157:(e,t,r)=>{"use strict";r.d(t,{ID:()=>w,en:()=>R,Xv:()=>D,FU:()=>M,gs:()=>T,tt:()=>F,jY:()=>G,T6:()=>A,ZP:()=>$});var n=r(472500),o=r.n(n),i=r(701469),u=r.n(i),a=r(984596),l=r.n(a),c=r(227361),s=r.n(c),f=r(505055),p=r.n(f),y=r(375875),d=r.n(y),v=r(737275),m=r(916651),b=r(577215);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function h(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B={},P="1.3.0",w="1.1.1",R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{service:"WMS",version:P,request:"GetCapabilities"},r=arguments.length>2?arguments[2]:void 0,n=(u()(e)&&e||e.split(","))[0],i=o().parse(n,!0);return o().format(S(S({},i),{},{search:null,query:S(S(S({},t),i.query),(null==r?void 0:r.query)||{})}))},j=function(e){var t=e&&e.Title,r=e.LogoURL&&S(S({},s()(e,"LogoURL.$")||{}),{},{format:s()(e,"LogoURL.Format")}),n=s()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:s()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},D=function e(t){var r,n,o=null!==(r=null==t?void 0:t.Layer)&&void 0!==r?r:null==t?void 0:t.layer,i=null!==(n=null==t?void 0:t.Name)&&void 0!==n?n:null==t?void 0:t.name;return o?l()(o).reduce((function(t,r){var n,o,i=null!==(n=r.Layer)&&void 0!==n?n:r.layer,u=null!==(o=r.Name)&&void 0!==o?o:r.name;return[].concat(h(t),h(e(r)),h(i&&u?[r]:[]))}),[]):i&&[t]||[]},C=function(){var e,t,r,n,o,i,a,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,f=arguments.length>2?arguments[2]:void 0,p=arguments.length>3?arguments[3]:void 0,y=c.Capability,d=c.Service,v=(a=y).Request&&a.Request.GetMap&&a.Request.GetMap.DCPType&&a.Request.GetMap.DCPType.HTTP&&a.Request.GetMap.DCPType.HTTP.Get&&a.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&a.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0,m=y.Layer&&(null===(e=y.Layer.SRS||y.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],b=y.Layer&&y.Layer.Attribution&&j(y.Layer.Attribution),g=l()((null==y||null===(t=y.Request)||void 0===t||null===(r=t.GetMap)||void 0===r?void 0:r.Format)||[]),h=l()((null==y||null===(n=y.Request)||void 0===n||null===(o=n.GetFeatureInfo)||void 0===o?void 0:o.Format)||[]),L=D(y),O=(u()(L)?L:[L]).filter((function(e){return!p||-1!==e.Name.toLowerCase().indexOf(p.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(p.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(p.toLowerCase())}));return{numberOfRecordsMatched:O.length,numberOfRecordsReturned:Math.min(f,O.length),nextRecord:s+Math.min(f,O.length)+1,service:d,layerOptions:{version:(null==c||null===(i=c.$)||void 0===i?void 0:i.version)||P},records:O.filter((function(e,t){return t>=s-1&&t<s-1+f})).map((function(e){return S(S({},e),{},{getMapFormats:g,getFeatureInfoFormats:h,onlineResource:v,SRS:m,credits:e.Attribution?j(e.Attribution):b})}))}},M=function(e){return d().get(R(e,{service:"WMS",version:P,request:"GetCapabilities"})).then((function(e){var t;return p().parseString(e.data,{explicitArray:!1},(function(e,r){t=r})),t.WMS_Capabilities||t.WMT_MS_Capabilities||{}}))},q=function(e,t,r,n){var o=B[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,v.u8)("cacheExpire")||60)?new Promise((function(e){e(C(o.data,t,r,n))})):M(e).then((function(o){return B[e]={timestamp:(new Date).getTime(),data:o},C(o,t,r,n)}))},T=function(e,t){return d().get(R(e,{service:"WMS",version:w,layers:t,request:"DescribeLayer"})).then((function(e){var t;return p().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return S(S({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:S({},e&&e.query&&e.query.$||{})})}))}))},F=function(e,t,r,n){return q(e,t,r,n)},G=function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,m.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,m.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},A=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return M(e).then((function(e){var r,n,o,i,u=e.Capability,a=l()((null==u||null===(r=u.Request)||void 0===r||null===(n=r.GetMap)||void 0===n?void 0:n.Format)||[]).filter(b.F0);return t?{imageFormats:a,infoFormats:l()((null==u||null===(o=u.Request)||void 0===o||null===(i=o.GetFeatureInfo)||void 0===i?void 0:i.Format)||[]).filter(b.cP)}:a})).catch((function(){return t?{imageFormats:[],infoFormats:[]}:[]}))};const $={flatLayers:D,parseUrl:R,getDimensions:function(e){return l()(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&l()(e.Extent)[r]||e.extent&&l()(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t._.split(",")||n&&n._&&n._.split(",")}}))},getCapabilities:M,describeLayer:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d().get(R(e,{service:"WMS",version:w,layers:t,request:"DescribeLayer"},r)).then((function(e){var t,r,n;p().parseString(e.data,{explicitArray:!1},(function(e,t){n=t}));var o=(null===(t=n)||void 0===t||null===(r=t.WMS_DescribeLayerResponse)||void 0===r?void 0:r.LayerDescription)&&l()(n.WMS_DescribeLayerResponse.LayerDescription)[0];return o&&S(S({},null==o?void 0:o.$),(null==o?void 0:o.Query)&&{query:l()(o.Query).map((function(e){return S({},null==e?void 0:e.$)}))})}))},getRecords:q,describeLayers:T,textSearch:F,parseLayerCapabilities:function(e,t){var r=e.Capability;return D(r).find((function(e){var r=e.Name;return 2===t.name.split(":").length&&r&&2===r.split(":").length?t.name===r&&e:r&&2===r.split(":").length?t.name===r.split(":")[1]&&e:2===t.name.split(":").length?t.name.split(":")[1]===r&&e:t.name===r&&e}))},getBBox:G,reset:function(){Object.keys(B).forEach((function(e){delete B[e]}))},getSupportedFormat:A}},680833:(e,t,r)=>{"use strict";r.d(t,{kB:()=>g,HI:()=>h});var n=r(472500),o=r.n(n),i=(r(91175),r(490173)),u=r(49977),a=r(501157),l=r(375875),c=r.n(l),s=(r(916651),r(624262)),f=r(510284),p=r(233044),y=r(611847);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i.default;var g=function(e){return u.Observable.defer((function(){return a.ZP.getCapabilities((0,s.Fh)(e))})).let(f.oB).map((function(t){return a.ZP.parseLayerCapabilities(t,e)}))},h=function(e){return function(e){return u.Observable.defer((function(){return c().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,i=e.url,u=o().parse((0,y.eW)(n.url||i),!0);return o().format(m(m({},u),{},{search:void 0,query:m(m({},u.query),{},{service:"WMS",version:a.ID,layers:t,outputFormat:"application/json",request:"DescribeLayer"})}))}(e))})).let(f.oB)}(e).map((function(e){var t=e.data,r=void 0===t?{}:t;return r&&r.layerDescriptions[0]})).map((function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).owsURL;return m(m({},e),{},{params:{},search:t?{type:"wfs",url:(0,p.cleanAuthParamsFromURL)(t)}:void 0})}))}}}]);