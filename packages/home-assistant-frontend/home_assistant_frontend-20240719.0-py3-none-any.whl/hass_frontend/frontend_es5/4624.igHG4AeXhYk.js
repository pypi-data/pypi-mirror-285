"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[4624],{20712:function(t,e,n){n.d(e,{E:function(){return l}});var a=n(64782),i=n(35806),r=n(71008),s=n(62193),o=n(2816),u=n(27927),c=n(14562),d=n(19867),h=(n(81027),n(82386),n(95737),n(39790),n(66457),n(36604),n(253),n(4525),n(96858),n(29818)),l=function(t){var e=(0,u.A)(null,(function(t,e){var n=function(e){function n(){var e;(0,r.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=(0,s.A)(this,n,[].concat(i)),t(e),e}return(0,o.A)(n,e),(0,i.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,c.A)((0,d.A)(n.prototype),"connectedCallback",this).call(this),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,c.A)((0,d.A)(n.prototype),"disconnectedCallback",this).call(this),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then((function(t){return t()})):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,c.A)((0,d.A)(n.prototype),"updated",this).call(this,t),t.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var e,i=(0,a.A)(t.keys());try{for(i.s();!(e=i.n()).done;){var r=e.value;if(this.hassSubscribeRequiredHostProps.includes(r))return void this.__checkSubscribed()}}catch(s){i.e(s)}finally{i.f()}}}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((function(t){return void 0===e[t]}))||(this.__unsubs=this.hassSubscribe())}}]}}),t);return e}},37334:function(t,e,n){var a=n(22858).A,i=n(33994).A;n.a(t,function(){var t=a(i().mark((function t(a,r){var s,o,u,c,d,h,l,f,p,v,k,_,m;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,m=function(t,e,n,a,i,r,s){var o=(0,c.c)(e,t),u=void 0!==r&&void 0!==s;if(u&&o<=35){var v=(0,d.M)(e,t),k=(0,d.M)(s,r);k>v?e=(0,h.L)(e,k-v):v>k&&(s=(0,h.L)(s,v-k))}var m={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:_(o,e),adapters:{date:{locale:n,config:a}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:o>35?"monthyear":o>7?"date":o>2?"weekday":o>0?"datetime":"hour",minUnit:o>35?"month":o>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(t){return(0,l.ZV)(Math.abs(t),n)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(o>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(u?"".concat((0,f.sl)(e,n,a),": "):"").concat((0,p.fU)(e,n,a)," â€“ ").concat((0,p.fU)((0,h.L)(e,1),n,a))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,l.ZV)(t.parsed.y,n)," ").concat(i)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,l.Yf)(n)};return u&&(m.scales.xAxisCompare=Object.assign(Object.assign({},m.scales.x),{},{suggestedMin:r.getTime(),max:_(o,s),display:!1})),m},_=function(t,e){var n=new Date(e);return t>2&&0===n.getHours()&&(n=(0,u.O)(n,1)),n.setMinutes(0,0,0),t>35&&n.setDate(1),t>2&&n.setHours(0),n.getTime()},n.d(e,{o:function(){return m}}),s=n(81027),o=n(26098),u=n(65513),c=n(31195),d=n(6711),h=n(83324),l=n(57636),f=n(57289),p=n(41924),!(v=a([l,f,p])).then){t.next=23;break}return t.next=19,v;case 19:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=24;break;case 23:t.t0=v;case 24:k=t.t0,l=k[0],f=k[1],p=k[2],r(),t.next=34;break;case 31:t.prev=31,t.t2=t.catch(0),r(t.t2);case 34:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(e,n){return t.apply(this,arguments)}}())},1799:function(t,e,n){var a=n(22858).A,i=n(33994).A;n.a(t,function(){var t=a(i().mark((function t(a,r){var s,o,u,c,d,h,l,f,p,v,k,_,m,g,b,y,x,A,S,w,D,M,C,E,H,P,F,O,R,q,N,U,j,z,T,Y,I,L,Z,W,V,$,G,B,J,K,Q,X,tt;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return tt}}),s=n(64782),o=n(41981),u=n(64599),c=n(35806),d=n(71008),h=n(62193),l=n(2816),f=n(27927),p=n(81027),v=n(39805),k=n(95737),_=n(97741),m=n(89655),g=n(33231),b=n(50693),y=n(26098),x=n(39790),A=n(74268),S=n(99019),w=n(253),D=n(54846),M=n(16891),C=n(19588),E=n(40322),H=n(41499),P=n(3714),F=n(64961),O=n(62726),R=n(19192),q=n(66555),N=n(96858),U=n(79784),j=n(75697),z=n(15112),T=n(29818),Y=n(85323),I=n(94100),L=n(46999),n(13082),Z=n(47076),W=n(4826),V=n(20712),$=n(7934),G=n(37334),!(B=a([Z,G])).then){t.next=78;break}return t.next=74,B;case 74:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=79;break;case 78:t.t0=B;case 79:J=t.t0,Z=J[0],G=J[1],tt=(0,f.A)([(0,T.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){var n=function(e){function n(){var e;(0,d.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return e=(0,h.A)(this,n,[].concat(i)),t(e),e}return(0,l.A)(n,e),(0,c.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,T.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,T.wk)()],key:"_chartDatasetExtra",value:function(){return[]}},{kind:"field",decorators:[(0,T.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_start",value:function(){return(0,U.R)()}},{kind:"field",decorators:[(0,T.wk)()],key:"_end",value:function(){return(0,j.o)()}},{kind:"field",decorators:[(0,T.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,T.wk)()],key:"_hiddenStats",value:function(){return new Set}},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,Z.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t,e._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,$.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,z.qy)(K||(K=(0,u.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base externalHidden .hass="','" .data="','" .extraData="','" .options="','" chart-type="bar" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,z.qy)(Q||(Q=(0,u.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,Y.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._chartDatasetExtra,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):z.s6}},{kind:"method",key:"_datasetHidden",value:function(t){t.stopPropagation(),this._hiddenStats.add(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"method",key:"_datasetUnhidden",value:function(t){t.stopPropagation(),this._hiddenStats.delete(this._data.prefs.device_consumption[t.detail.index].stat_consumption),this.requestUpdate("_hiddenStats")}},{kind:"field",key:"_createOptions",value:function(){return(0,I.A)((function(t,e,n,a,i,r,s){var o=(0,G.o)(t,e,n,a,i,r,s);return Object.assign(Object.assign({},o),{},{interaction:{mode:"nearest"},plugins:Object.assign(Object.assign({},o.plugins),{},{legend:{display:!0,labels:{usePointStyle:!0}}})})}))}},{kind:"method",key:"_processStatistics",value:function(){var t=this._data,e=t.stats,n=t.statsCompare,a=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((function(t){var n=t.stat_consumption in e&&(0,W.$j)(e[t.stat_consumption])||0;i[t.stat_consumption]=n}));var r=t.prefs.device_consumption.map((function(t){return t.stat_consumption}));r.sort((function(t,e){return i[e]-i[t]}));var s=[],u=[],c=this._processDataSet(a,e,t.statsMetadata,t.prefs.device_consumption,r),d=c.data,h=c.dataExtras;if(s.push.apply(s,(0,o.A)(d)),u.push.apply(u,(0,o.A)(h)),n){s.push({order:0,data:[]}),u.push({show_legend:!1}),s.push({order:999,data:[],xAxisID:"xAxisCompare"}),u.push({show_legend:!1});var l=this._processDataSet(a,n,t.statsMetadata,t.prefs.device_consumption,r,!0),f=l.data,p=l.dataExtras;s.push.apply(s,(0,o.A)(f)),u.push.apply(u,(0,o.A)(p))}this._start=t.start,this._end=t.end||(0,j.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:s},this._chartDatasetExtra=u}},{kind:"method",key:"_processDataSet",value:function(t,e,n,a,i){var r=this,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=[],c=[];return a.forEach((function(a,d){var h,l=(0,L.fI)(d,t),f=null,p=[];if(a.stat_consumption in e){var v,k,_=e[a.stat_consumption],m=(0,s.A)(_);try{for(m.s();!(k=m.n()).done;){var g=k.value;if(null!==g.change&&void 0!==g.change&&f!==g.start){var b=new Date(g.start);p.push({x:b.getTime(),y:g.change}),f=g.start,v=g.end}}}catch(A){m.e(A)}finally{m.f()}1===p.length&&p.push({x:v,y:0})}var y=i.indexOf(a.stat_consumption),x=!!(null!==(h=r._config)&&void 0!==h&&h.max_devices&&y>=r._config.max_devices);u.push({label:a.name||(0,W.$O)(r.hass,a.stat_consumption,n[a.stat_consumption]),hidden:r._hiddenStats.has(a.stat_consumption)||x,borderColor:o?l+"7F":l,backgroundColor:o?l+"32":l+"7F",data:p,order:1+y,stack:"devices",pointStyle:!o&&"circle",xAxisID:o?"xAxisCompare":void 0}),c.push({show_legend:!o&&!x})})),{data:u,dataExtras:c}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,z.AH)(X||(X=(0,u.A)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),(0,V.E)(z.WF)),r(),t.next=90;break;case 87:t.prev=87,t.t2=t.catch(0),r(t.t2);case 90:case"end":return t.stop()}}),t,null,[[0,87]])})));return function(e,n){return t.apply(this,arguments)}}())},61310:function(t,e,n){n.d(e,{f:function(){return r}});var a=n(30429),i=n(59613);function r(t,e){var n=(0,a.a)(t);return isNaN(e)?(0,i.w)(t,NaN):e?(n.setDate(n.getDate()+e),n):n}},83324:function(t,e,n){n.d(e,{L:function(){return r}});var a=n(31293),i=n(3941);function r(t,e){return(0,a.A)(t,e*i.s0)}},31293:function(t,e,n){n.d(e,{A:function(){return r}});var a=n(30429),i=n(59613);function r(t,e){var n=+(0,a.a)(t);return(0,i.w)(t,n+e)}},39902:function(t,e,n){n.d(e,{P:function(){return r}});var a=n(30429),i=n(59613);function r(t,e){var n=(0,a.a)(t);if(isNaN(e))return(0,i.w)(t,NaN);if(!e)return n;var r=n.getDate(),s=(0,i.w)(t,n.getTime());return s.setMonth(n.getMonth()+e+1,0),r>=s.getDate()?s:(n.setFullYear(s.getFullYear(),s.getMonth(),r),n)}},24226:function(t,e,n){n.d(e,{z:function(){return i}});var a=n(30429);function i(t,e){var n=(0,a.a)(t),i=(0,a.a)(e),r=n.getTime()-i.getTime();return r<0?-1:r>0?1:r}},6711:function(t,e,n){n.d(e,{M:function(){return s}});var a=n(48240),i=n(3941),r=n(27320);function s(t,e,n){var s=(0,r.b)(t,e)/i.s0;return(0,a.u)(null==n?void 0:n.roundingMethod)(s)}},27320:function(t,e,n){n.d(e,{b:function(){return i}});var a=n(30429);function i(t,e){return+(0,a.a)(t)-+(0,a.a)(e)}},72730:function(t,e,n){n.d(e,{W:function(){return o}});n(29193);var a=n(24226),i=n(30429);function r(t,e){var n=(0,i.a)(t),a=(0,i.a)(e);return 12*(n.getFullYear()-a.getFullYear())+(n.getMonth()-a.getMonth())}var s=n(91103);function o(t,e){var n,o=(0,i.a)(t),u=(0,i.a)(e),c=(0,a.z)(o,u),d=Math.abs(r(o,u));if(d<1)n=0;else{1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-c*d);var h=(0,a.z)(o,u)===-c;(0,s.c)((0,i.a)(t))&&1===d&&1===(0,a.z)(t,u)&&(h=!1),n=c*(d-Number(h))}return 0===n?0:n}},60132:function(t,e,n){n.d(e,{D:function(){return i}});var a=n(30429);function i(t){var e=(0,a.a)(t);return e.setHours(23,59,59,999),e}},12152:function(t,e,n){n.d(e,{p:function(){return i}});var a=n(30429);function i(t){var e=(0,a.a)(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}},75697:function(t,e,n){n.d(e,{o:function(){return i}});var a=n(60132);function i(){return(0,a.D)(Date.now())}},77301:function(t,e,n){n.d(e,{e:function(){return i}});var a=n(30429);function i(t){return 1===(0,a.a)(t).getDate()}},91103:function(t,e,n){n.d(e,{c:function(){return s}});var a=n(60132),i=n(12152),r=n(30429);function s(t){var e=(0,r.a)(t);return+(0,a.D)(e)==+(0,i.p)(e)}},79784:function(t,e,n){n.d(e,{R:function(){return i}});var a=n(63165);function i(){return(0,a.o)(Date.now())}},65513:function(t,e,n){n.d(e,{O:function(){return i}});var a=n(83324);function i(t,e){return(0,a.L)(t,-e)}}}]);
//# sourceMappingURL=4624.igHG4AeXhYk.js.map