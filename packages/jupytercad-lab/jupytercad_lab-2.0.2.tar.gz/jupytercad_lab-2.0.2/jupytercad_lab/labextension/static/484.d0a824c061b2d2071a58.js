"use strict";(self.webpackChunk_jupytercad_jupytercad_lab=self.webpackChunk_jupytercad_jupytercad_lab||[]).push([[484],{484:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var r=a(650),o=a(640),d=a(974),n=a(130),s=a(605),i=a(796),l=a(74),c=a(465),u=a(230),p=a(256),g=a(78);class y extends g.JupyterYModel{}class h extends p.Panel{constructor(e){super(),this.onResize=()=>{this._jcadWidget&&u.MessageLoop.sendMessage(this._jcadWidget,p.Widget.ResizeMessage.UnknownSize)},this.addClass("jupytercad-notebook-widget"),this._jcadWidget=new r.JupyterCadPanel(e),this.addWidget(this._jcadWidget)}}const M={id:"jupytercad:yjswidget-plugin",autoStart:!0,requires:[o.IJCadWorkerRegistryToken],optional:[g.IJupyterYWidgetManager,s.ITranslator],activate:(e,t,a,r)=>{if(!a)return void console.error("Missing IJupyterYWidgetManager token!");const d=null!=r?r:s.nullTranslator;a.registerWidget("@jupytercad:widget",class extends y{ydocFactory(t){const{path:a,format:r,contentType:n}=t;this.jupyterCADModel=new o.JupyterCadModel({});const s=e.serviceManager.user;if(a&&r&&n){const e=c.ServerConnection.makeSettings(),t=l.URLExt.join(e.wsUrl,"api/collaboration/room"),o=new i.WebSocketProvider({url:t,path:a,format:r,contentType:n,model:this.jupyterCADModel.sharedModel,user:s,translator:d.load("jupyterlab")});this.jupyterCADModel.disposed.connect((()=>{o.dispose()}))}else{const e=this.jupyterCADModel.sharedModel.awareness,t=t=>{e.setLocalStateField("user",t.identity)};s.ready.then((()=>{t(s)})).catch((e=>console.error(e))),s.userChanged.connect(t,this)}return this.jupyterCADModel.sharedModel.ydoc}},class{constructor(e,a){this.yModel=e,this.node=a;const r=new h({model:e.jupyterCADModel,workerRegistry:t});u.MessageLoop.sendMessage(r,p.Widget.Msg.BeforeAttach),a.appendChild(r.node),u.MessageLoop.sendMessage(r,p.Widget.Msg.AfterAttach)}})}},C="jupytercad",m=[{id:"jupytercad:lab:main-menu",autoStart:!0,requires:[o.IJupyterCadDocTracker,o.IJCadFormSchemaRegistryToken,o.IJCadWorkerRegistryToken],optional:[n.IMainMenu,s.ITranslator],activate:(e,t,a,o,d,n)=>{console.log("jupytercad:lab:main-menu is activated!"),n=null!=n?n:s.nullTranslator;(0,r.addCommands)(e,t,n,a,o),d&&function(e,t){e.fileMenu.addItem({command:r.CommandIDs.exportJcad}),e.editMenu.undoers.redo.add({id:r.CommandIDs.redo,isEnabled:t}),e.editMenu.undoers.undo.add({id:r.CommandIDs.undo,isEnabled:t})}(d,(()=>null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget))}},{id:"jupytercad:lab:controlpanel",autoStart:!0,requires:[d.ILayoutRestorer,o.IJupyterCadDocTracker,o.IAnnotationToken,o.IJCadFormSchemaRegistryToken],activate:(e,t,a,o,d)=>{const n=new r.ControlPanelModel({tracker:a}),s=new r.LeftPanelWidget({model:n,annotationModel:o,tracker:a});s.id="jupytercad::leftControlPanel",s.title.caption="JupyterCad Control Panel",s.title.icon=r.jcLightIcon;const i=new r.RightPanelWidget({model:n,tracker:a,formSchemaRegistry:d});i.id="jupytercad::rightControlPanel",i.title.caption="JupyterCad Control Panel",i.title.icon=r.jcLightIcon,t&&(t.add(s,C),t.add(i,C)),e.shell.add(s,"left",{rank:2e3}),e.shell.add(i,"right",{rank:2e3})}},M]}}]);