(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2815],{24081:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/messaging",function(){return n(3714)}])},25010:function(e,t,n){"use strict";var i=n(85034),s=n(70169),r=n(24246),a=n(83265),o=n(88038),l=n.n(o);n(27378);t.Z=function(e){var t=e.children,n=e.title,o=e.mainProps;return(0,r.jsxs)(a.kCb,{"data-testid":n,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 200px)",children:[(0,r.jsxs)(l(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(a.kCb,(0,s.Z)((0,i.Z)({pt:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0},o),{children:t}))]})}},66081:function(e,t,n){"use strict";var i=n(24246),s=n(83265);t.Z=function(e){var t=e.title,n=e.text,r=e.onClose;return(0,i.jsxs)(s.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[r&&(0,i.jsx)(s.Two,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:r}),(0,i.jsx)(s.iid,{alignSelf:"start",color:"blue.400",mt:.5,flexGrow:0}),(0,i.jsxs)(s.kCb,{direction:"column",gap:2,flexGrow:1,children:[(0,i.jsx)(s.X6q,{fontSize:"md",children:t}),(0,i.jsx)(s.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:n})]})]})}},87594:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(85034),s=n(70169),r=n(31373),a=n(24246),o=n(83265),l=n(98784),c=n(27378),u=n(79894),d=n.n(u),m=function(e){var t=e.breadcrumbs;return(0,a.jsx)(o.aGc,{separator:"->",fontSize:"2xl",fontWeight:"semibold","data-testid":"breadcrumbs",children:t.map((function(e,n){var i=n+1===t.length,s=!!e.link||!!e.onClick;return(0,a.jsx)(o.gN6,{color:i||e.isOpaque?"black":"gray.500",children:s?(0,a.jsx)(o.Atw,{as:d(),href:e.link,isCurrentPage:i,children:e.title}):(0,a.jsx)(o.Atw,{_hover:{textDecoration:"none",cursor:"default"},isCurrentPage:i,children:e.title})},e.title)}))})},p=function(e){var t=e.breadcrumbs,n=e.isSticky,u=void 0===n||n,d=e.children,p=(0,r.Z)(e,["breadcrumbs","isSticky","children"]);return(0,a.jsxs)(o.xuv,(0,s.Z)((0,i.Z)({bgColor:"white",paddingY:5},u?{position:"sticky",top:0,left:0,zIndex:10}:{},p),{children:[(0,l.isArray)(t)&&(0,a.jsx)(o.xuv,{marginBottom:d?4:0,children:(0,a.jsx)(m,{breadcrumbs:t})}),(0,c.isValidElement)(t)&&t,d]}))}},10437:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i,s,r=n(17599);!function(e){e.PRIVACY_REQUEST_REVIEW_APPROVE="privacy_request_review_approve",e.PRIVACY_REQUEST_REVIEW_DENY="privacy_request_review_deny",e.PRIVACY_REQUEST_RECEIPT="privacy_request_receipt",e.PRIVACY_REQUEST_COMPLETE_ACCESS="privacy_request_complete_access",e.PRIVACY_REQUEST_COMPLETE_DELETION="privacy_request_complete_deletion",e.SUBJECT_IDENTITY_VERIFICATION="subject_identity_verification"}(i||(i={}));var a=(s={},(0,r.Z)(s,i.PRIVACY_REQUEST_COMPLETE_ACCESS,"Access request completed"),(0,r.Z)(s,i.PRIVACY_REQUEST_COMPLETE_DELETION,"Erasure request completed"),(0,r.Z)(s,i.PRIVACY_REQUEST_RECEIPT,"Privacy request received"),(0,r.Z)(s,i.PRIVACY_REQUEST_REVIEW_APPROVE,"Privacy request approved"),(0,r.Z)(s,i.PRIVACY_REQUEST_REVIEW_DENY,"Privacy request denied"),(0,r.Z)(s,i.SUBJECT_IDENTITY_VERIFICATION,"Subject identity verification"),s)},65209:function(e,t,n){"use strict";n.d(t,{Vw:function(){return a},ms:function(){return s},pS:function(){return r},vm:function(){return o}});var i=n(85768).u.injectEndpoints({endpoints:function(e){return{getSummaryMessagingTemplates:e.query({query:function(e){return{method:"GET",url:"plus/messaging/templates/summary",params:e}},providesTags:function(){return["Property-Specific Messaging Templates"]}}),putMessagingTemplateById:e.mutation({query:function(e){var t=e.templateId,n=e.template;return{url:"plus/messaging/templates/".concat(t),method:"PUT",body:n}},invalidatesTags:function(){return["Property-Specific Messaging Templates"]}}),patchMessagingTemplateById:e.mutation({query:function(e){var t=e.templateId,n=e.template;return{url:"plus/messaging/templates/".concat(t),method:"PATCH",body:n}},invalidatesTags:function(){return["Property-Specific Messaging Templates"]}}),createMessagingTemplateByType:e.mutation({query:function(e){var t=e.templateType,n=e.template;return{url:"plus/messaging/templates/".concat(t),method:"POST",body:n}},invalidatesTags:function(){return["Property-Specific Messaging Templates"]}})}}}),s=i.useGetSummaryMessagingTemplatesQuery,r=i.usePutMessagingTemplateByIdMutation,a=i.useCreateMessagingTemplateByTypeMutation,o=i.usePatchMessagingTemplateByIdMutation},3714:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return V}});var i=n(23842),s=n(85034),r=n(52050),a=n(85556),o=n(24246),l=n(92222),c=n(59003),u=n(83265),d=n(98784),m=n(86677),p=n(27378),g=n(25010),f=n(70885),h=n(66081),x=n(93677),v=n(87594),y=n(12934),E=n(73659),_=n(74618),b=n(69883),j=n(56071),C=n(10437),T=function(e){var t=e.isOpen,n=e.onClose,i=e.onAccept,s=(0,p.useState)(void 0),r=s[0],a=s[1],l=Object.keys(C.Z).map((function(e){return{value:e,label:C.Z[e]}}));return(0,o.jsxs)(u.u_l,{isOpen:t,onClose:n,size:"2xl",isCentered:!0,children:[(0,o.jsx)(u.ZAr,{}),(0,o.jsxs)(u.hzk,{"data-testid":"add-messaging-template-modal",children:[(0,o.jsx)(u.xBx,{borderBottomWidth:1,fontWeight:"bold",children:"Select message template"}),(0,o.jsxs)(u.fef,{children:[(0,o.jsx)(u.xvT,{color:"gray.700",fontWeight:"medium",fontSize:"sm",marginBottom:3,marginTop:1,children:"Add a new email message by selecting a template below and clicking accept."}),(0,o.jsx)(u.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"medium",marginBottom:2,children:"Choose template:"}),(0,o.jsx)(u.xuv,{"data-testid":"template-type-selector",children:(0,o.jsx)(b.Z,{options:l,size:"sm",chakraStyles:j.hP,onChange:function(e){a(null===e||void 0===e?void 0:e.value)},classNamePrefix:"custom-select"})})]}),(0,o.jsx)(u.mzw,{justifyContent:"flex-start",children:(0,o.jsxs)(u.hE2,{size:"sm",display:"flex",justifyItems:"stretch",w:"full",children:[(0,o.jsx)(u.zxk,{variant:"outline",mr:2,onClick:n,"data-testid":"cancel-btn",size:"md",flex:1,children:"Cancel"}),(0,o.jsx)(u.zxk,{size:"md",colorScheme:"primary",bgColor:"primary.800",onClick:function(){return i(r)},"data-testid":"confirm-btn",isDisabled:!r,flex:1,children:"Next"})]})})]})]})},P=n(65209),S=n(32556),I=n(61186),R=n(34038),w=function(){var e=(0,u.pmc)(),t=(0,r.Z)((0,P.vm)(),1)[0],n=(0,p.useCallback)(function(){var n=(0,i.Z)((function(n){var i,s,r;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=n.isEnabled,s=n.templateId,[4,t({templateId:s,template:{is_enabled:i}})];case 1:return r=a.sent(),(0,R.D4)(r)?(e((0,I.Vo)((0,S.e$)(r.error))),[2]):(e((0,I.t5)("Messaging template ".concat(i?"enabled":"disabled"))),[2])}}))}));return function(e){return n.apply(this,arguments)}}(),[t,e]);return{toggleIsTemplateEnabled:n}},k=n(62257),Z=(0,l.Cl)(),z={items:[],total:0,page:1,size:50,pages:1},M=function(){return(0,o.jsx)(u.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",textAlign:"center",children:(0,o.jsxs)(u.gCW,{children:[(0,o.jsx)(u.xvT,{fontSize:"md",fontWeight:"600",children:"It looks like it\u2019s your first time here!"}),(0,o.jsxs)(u.xvT,{fontSize:"sm",children:["Add new email templates with the ",'"Add message +"'," button.",(0,o.jsx)("br",{})]})]})})},A=function(){var e=(0,k.gz)({page:1,size:100}),t=e.isLoading,n=e.data,i=null===n||void 0===n?void 0:n.items.filter((function(e){return!e.messaging_templates||0===e.messaging_templates.length})),s=Boolean(!t&&(null===i||void 0===i?void 0:i.length)),a="missing-messages-notice-".concat(null===i||void 0===i?void 0:i.map((function(e){return e.id})).join("-")),l=(0,r.Z)((0,f._)("notices.dismissedMessageNoticeId",""),2),c=l[0],d=l[1];return s&&!(a===c)?(0,o.jsx)(u.xuv,{mb:6,"data-testid":"notice-properties-without-messaging-templates",children:(0,o.jsx)(h.Z,{title:"Not all properties have messages configured.",text:(0,o.jsxs)(u.xvT,{as:"span",children:["You have properties that do not have messages configured. Users who submit privacy requests for these properties may not receive the necessary emails regarding their requests."," ",(0,o.jsx)(u.xuv,{as:"span",children:(0,o.jsx)(y.Z,{label:null===i||void 0===i?void 0:i.map((function(e){return e.name})).join(", ")})})]}),onClose:function(){d(a)}})}):null},V=function(){var e=(0,m.useRouter)(),t=w().toggleIsTemplateEnabled,n=(0,E.oi)(),r=n.PAGE_SIZES,f=n.pageSize,h=n.setPageSize,y=n.onPreviousPageClick,b=n.isPreviousPageDisabled,j=n.onNextPageClick,S=n.isNextPageDisabled,I=n.startRange,R=n.endRange,k=n.pageIndex,V=n.setTotalPages,N=(0,P.ms)({page:k,size:f}),q=N.data,O=N.isLoading,B=N.isFetching,U=(0,p.useMemo)((function(){return null!==q&&void 0!==q?q:z}),[q]),W=U.items,Y=U.total,D=U.pages;(0,p.useEffect)((function(){V(D)}),[D,V]);var Q=(0,p.useState)(!1),L=Q[0],G=Q[1],F=(0,p.useMemo)((function(){return[Z.accessor((function(e){return e.type}),{id:"message",cell:function(e){return(0,o.jsx)(E.G3,{value:C.Z[e.getValue()]})},header:function(e){return(0,o.jsx)(E.Rr,(0,s.Z)({value:"Message"},e))},size:150}),Z.accessor((function(e){return(e.properties||[]).map((function(e){return e.name}))}),{id:"properties",cell:function(e){return(0,o.jsx)(E.WP,(0,s.Z)({suffix:"properties",value:e.getValue()},e))},header:function(e){return(0,o.jsx)(E.Rr,(0,s.Z)({value:"Properties"},e))},meta:{displayText:"Properties",showHeaderMenu:!0},size:250}),Z.accessor((function(e){return e.is_enabled}),{id:"is_enabled",cell:function(e){return(0,o.jsx)(u.kCb,{align:"center",justifyContent:"flex-start",w:"full",h:"full",children:(0,o.jsx)(u.rsf,{name:"is_enabled_".concat(e.row.original.id),isChecked:e.getValue(),colorScheme:"complimentary",onChange:function(){var n=(0,i.Z)((function(n){return(0,a.__generator)(this,(function(i){return t({isEnabled:n.target.checked,templateId:e.row.original.id}),[2]}))}));return function(e){return n.apply(this,arguments)}}()})})},header:function(e){return(0,o.jsx)(E.Rr,(0,s.Z)({value:"Enable"},e))},size:200,meta:{disableRowClick:!0}})]}),[t]),H=(0,p.useMemo)((function(){return(0,d.sortBy)(W,"id")}),[W]),X=(0,c.b7)({getCoreRowModel:(0,l.sC)(),getFilteredRowModel:(0,l.vL)(),getSortedRowModel:(0,l.tj)(),columns:F,data:H});return(0,o.jsxs)(g.Z,{title:"Messaging",mainProps:{padding:"0 40px 10px"},children:[(0,o.jsx)(v.Z,{breadcrumbs:[{title:"Messaging"}],children:(0,o.jsx)(u.xvT,{fontWeight:500,color:"gray.700",children:"Configure Fides messaging."})}),(0,o.jsx)(A,{}),(0,o.jsx)(E.Q$,{children:(0,o.jsx)(u.Ugi,{alignItems:"center",spacing:4,marginLeft:"auto",children:(0,o.jsx)(u.zxk,{size:"xs",colorScheme:"primary","data-testid":"add-message-btn",onClick:function(){return G(!0)},children:"Add message +"})})}),O?(0,o.jsx)(E.I4,{rowHeight:36,numRows:15}):(0,o.jsx)(E.ZK,{tableInstance:X,onRowClick:function(t){e.push({pathname:x.ax,query:{id:t.id}})},emptyTableNotice:(0,o.jsx)(M,{})}),(0,o.jsx)(_.s8,{totalRows:Y,pageSizes:r,setPageSize:h,onPreviousPageClick:y,isPreviousPageDisabled:b||B,onNextPageClick:j,isNextPageDisabled:S||B,startRange:I,endRange:R}),(0,o.jsx)(T,{isOpen:L,onClose:function(){return G(!1)},onAccept:function(t){e.push({pathname:x.sM,query:{templateType:t}})}})]})}},34038:function(e,t,n){"use strict";n.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=n(32764)}},function(e){e.O(0,[8033,3667,3659,9774,2888,179],(function(){return t=24081,e(e.s=t);var t}));var t=e.O();_N_E=t}]);