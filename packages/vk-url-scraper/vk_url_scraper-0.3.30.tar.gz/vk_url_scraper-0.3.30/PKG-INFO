Metadata-Version: 2.1
Name: vk-url-scraper
Version: 0.3.30
Summary: Scrape VK URLs to fetch info and media - python API or command line tool.
Author: Bellingcat
Author-email: tech@bellingcat.com
License: MIT
Project-URL: Code, https://github.com/bellingcat/vk-url-scraper
Project-URL: Documentation, https://vk-url-scraper.readthedocs.io/en/latest/
Keywords: scraper,vk,vkontakte,vk-api,media-downloader
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: Development Status :: 3 - Alpha
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: aiohttp==3.9.1
Requires-Dist: aiosignal==1.3.1
Requires-Dist: alabaster==0.7.16
Requires-Dist: anyio==4.4.0
Requires-Dist: async-timeout==4.0.3
Requires-Dist: attrs==23.2.0
Requires-Dist: Babel==2.15.0
Requires-Dist: backports.tarfile==1.2.0
Requires-Dist: beautifulsoup4==4.13.0b2
Requires-Dist: black==24.4.2
Requires-Dist: bleach==6.0.0
Requires-Dist: Brotli==1.1.0
Requires-Dist: certifi==2024.7.4
Requires-Dist: cffi==1.17.0rc1
Requires-Dist: charset-normalizer==3.3.2
Requires-Dist: click==8.1.7
Requires-Dist: colorama==0.4.6
Requires-Dist: commonmark==0.9.1
Requires-Dist: coverage==7.6.0
Requires-Dist: cryptography==42.0.8
Requires-Dist: docutils==0.18.1
Requires-Dist: exceptiongroup==1.2.2
Requires-Dist: flake8==7.1.0
Requires-Dist: frozenlist==1.4.1
Requires-Dist: furo==2023.3.27
Requires-Dist: h11==0.14.0
Requires-Dist: idna==3.7
Requires-Dist: imagesize==1.4.1
Requires-Dist: importlib_metadata==8.0.0
Requires-Dist: iniconfig==2.0.0
Requires-Dist: isort==6.0.0b2
Requires-Dist: jaraco.classes==3.4.0
Requires-Dist: jaraco.context==5.3.0
Requires-Dist: jaraco.functools==4.0.1
Requires-Dist: jeepney==0.8.0
Requires-Dist: Jinja2==3.1.4
Requires-Dist: keyring==25.2.1
Requires-Dist: livereload==2.6.3
Requires-Dist: markdown-it-py==2.2.0
Requires-Dist: MarkupSafe==2.1.5
Requires-Dist: mccabe==0.7.0
Requires-Dist: mdit-py-plugins==0.3.5
Requires-Dist: mdurl==0.1.2
Requires-Dist: more-itertools==10.3.0
Requires-Dist: multidict==6.0.4
Requires-Dist: mutagen==1.47.0
Requires-Dist: mypy==1.10.1
Requires-Dist: mypy-extensions==1.0.0
Requires-Dist: myst-parser==0.18.1
Requires-Dist: nh3==0.2.18
Requires-Dist: packaging==24.1
Requires-Dist: pathspec==0.12.1
Requires-Dist: pkginfo==1.10.0
Requires-Dist: platformdirs==4.2.2
Requires-Dist: pluggy==1.5.0
Requires-Dist: py==1.11.0
Requires-Dist: pycodestyle==2.12.0
Requires-Dist: pycparser==2.22
Requires-Dist: pycryptodomex==3.20.0
Requires-Dist: pyflakes==3.2.0
Requires-Dist: Pygments==2.18.0
Requires-Dist: pyparsing==3.0.9
Requires-Dist: pytest==8.2.2
Requires-Dist: pytest-cov==5.0.0
Requires-Dist: pytest-sphinx==0.6.3
Requires-Dist: python-dotenv==1.0.1
Requires-Dist: pytz==2022.1
Requires-Dist: PyYAML==6.0.2rc1
Requires-Dist: readme_renderer==43.0
Requires-Dist: requests==2.32.3
Requires-Dist: requests-toolbelt==1.0.0
Requires-Dist: rfc3986==2.0.0
Requires-Dist: rich==13.7.1
Requires-Dist: SecretStorage==3.3.3
Requires-Dist: six==1.16.0
Requires-Dist: sniffio==1.3.1
Requires-Dist: snowballstemmer==2.2.0
Requires-Dist: soupsieve==2.5
Requires-Dist: Sphinx==5.0.2
Requires-Dist: sphinx-autobuild==2024.4.16
Requires-Dist: sphinx-autodoc-typehints==1.19.1
Requires-Dist: sphinx-basic-ng==1.0.0b2
Requires-Dist: sphinx-copybutton==0.5.2
Requires-Dist: sphinxcontrib-applehelp==1.0.8
Requires-Dist: sphinxcontrib-devhelp==1.0.6
Requires-Dist: sphinxcontrib-htmlhelp==2.0.5
Requires-Dist: sphinxcontrib-jsmath==1.0.1
Requires-Dist: sphinxcontrib-qthelp==1.0.7
Requires-Dist: sphinxcontrib-serializinghtml==1.1.10
Requires-Dist: starlette==0.37.2
Requires-Dist: tomli==2.0.1
Requires-Dist: tornado==6.4
Requires-Dist: twine==5.1.1
Requires-Dist: typing_extensions==4.12.2
Requires-Dist: urllib3==2.2.2
Requires-Dist: uvicorn==0.30.1
Requires-Dist: vk-api==11.9.9
Requires-Dist: watchfiles==0.22.0
Requires-Dist: webencodings==0.5.1
Requires-Dist: websockets==12.0
Requires-Dist: yarl==1.9.4
Requires-Dist: yt-dlp==2024.7.15.232803.dev0
Requires-Dist: zipp==3.19.2
Provides-Extra: dev
Requires-Dist: flake8; extra == "dev"
Requires-Dist: mypy>=0.961; extra == "dev"
Requires-Dist: black>=22.3.0; extra == "dev"
Requires-Dist: isort>=5.10.1; extra == "dev"
Requires-Dist: pytest; extra == "dev"
Requires-Dist: pytest-sphinx; extra == "dev"
Requires-Dist: pytest-cov; extra == "dev"
Requires-Dist: twine>=1.11.0; extra == "dev"
Requires-Dist: setuptools; extra == "dev"
Requires-Dist: wheel; extra == "dev"
Requires-Dist: Sphinx<5.1.0,>=4.3.0; extra == "dev"
Requires-Dist: furo>=2022.6.4.1; extra == "dev"
Requires-Dist: myst-parser<0.19.0,>=0.15.2; extra == "dev"
Requires-Dist: sphinx-copybutton>=0.5.0; extra == "dev"
Requires-Dist: sphinx-autobuild>=2021.3.14; extra == "dev"
Requires-Dist: sphinx-autodoc-typehints; extra == "dev"
Requires-Dist: packaging; extra == "dev"
Requires-Dist: python-dotenv>=0.21.1; extra == "dev"

# vk-url-scraper
Python library to scrape data, and especially media links like videos and photos, from vk.com URLs.


[![PyPI version](https://badge.fury.io/py/vk-url-scraper.svg)](https://badge.fury.io/py/vk-url-scraper)
[![PyPI download month](https://img.shields.io/pypi/dm/vk-url-scraper.svg)](https://pypi.python.org/pypi/vk-url-scraper/)
[![Documentation Status](https://readthedocs.org/projects/vk-url-scraper/badge/?version=latest)](https://vk-url-scraper.readthedocs.io/en/latest/?badge=latest)


You can use it via the [command line](#command-line-usage) or as a [python library](#python-library-usage), check the **[documentation](https://vk-url-scraper.readthedocs.io/en/latest/)**.

## Installation
You can install the most recent release from [pypi](https://pypi.org/project/vk-url-scraper/) via `pip install vk-url-scraper`.

Currently you need to manually install one dependency (as it is installed from github and not pypi):
`pip install git+https://github.com/python273/vk_api.git@b99dac0ec2f832a6c4b20bde49869e7229ce4742`

To use the library you will need a valid username/password combination for vk.com. 

## Command line usage
```bash
# run this to learn more about the parameters
vk_url_scraper --help

# scrape a URL and get the JSON result in the console
vk_url_scraper --username "username here" --password "password here" --urls https://vk.com/wall12345_6789
# OR
vk_url_scraper -u "username here" -p "password here" --urls https://vk.com/wall12345_6789
# you can also have multiple urls
vk_url_scraper -u "username here" -p "password here" --urls https://vk.com/wall12345_6789 https://vk.com/photo-12345_6789 https://vk.com/video12345_6789

# you can pass a token as well to avoid always authenticating 
# and possibly getting captcha prompts
# you can fetch the token from the vk_config.v2.json file generated under by searching for "access_token"
vk_url_scraper -u "username" -p "password" -t "vktoken goes here" --urls https://vk.com/wall12345_6789

# save the JSON output into a file
vk_url_scraper -u "username here" -p "password here" --urls https://vk.com/wall12345_6789 > output.json

# download any photos or videos found in these URLS
# this will use or create an output/ folder and dump the files there
vk_url_scraper -u "username here" -p "password here" --download --urls https://vk.com/wall12345_6789
# or
vk_url_scraper -u "username here" -p "password here" -d --urls https://vk.com/wall12345_6789
```

## Python library usage
```python
from vk_url_scraper import VkScraper

vks = VkScraper("username", "password")

# scrape any "photo" URL
res = vks.scrape("https://vk.com/photo1_278184324?rev=1")

# scrape any "wall" URL
res = vks.scrape("https://vk.com/wall-1_398461")

# scrape any "video" URL
res = vks.scrape("https://vk.com/video-6596301_145810025")
print(res[0]["text"]) # eg: -> to get the text from code
```

```python
# Every scrape* function returns a list of dict like
{
	"id": "wall_id",
	"text": "text in this post" ,
	"datetime": utc datetime of post,
	"attachments": {
		# if photo, video, link exists
		"photo": [list of urls with max quality],
		"video": [list of urls with max quality],
		"link": [list of urls with max quality],
	},
	"payload": "original JSON response converted to dict which you can parse for more data
}
```

see [docs] for all available functions. 

### TODO
* scrape album links
* scrape profile links
* docs online from sphinx

## Development
(more info in [CONTRIBUTING.md](CONTRIBUTING.md)).

1. setup dev environment with `pip install -r dev-requirements.txt` or `pipenv install -r dev-requirements.txt`
1. setup environment with `pip install -r requirements.txt` or `pipenv install -r requirements.txt`
2. To run all checks to `make run-checks` (fixes style) or individually
   1. To fix style: `black .` and `isort .` -> `flake8 .` to validate lint
   2. To do type checking: `mypy .`
   3. To test: `pytest .` (`pytest -v --color=yes --doctest-modules tests/ vk_url_scraper/` to use verbose, colors, and test docstring examples)
3. `make docs` to generate shpynx docs -> edit [config.py](docs/source/conf.py) if needed

To test the command line interface available in [__main__.py](__vk_url_scraper/__main__.py) you need to pass the `-m` option to python like so: `python -m vk_url_scraper -u "" -p "" --urls ...`


## Releasing new version
1. edit [version.py](vk_url_scraper/version.py) with proper versioning
2. make sure to run `pipenv run pip freeze > requirements.txt` if you manage libs with pipenv
   1. if the hardcoded version of [vk_api](https://github.com/python273/vk_api) is still being used, then you must comment/remove that line from the generated requirements file and instruct users to manually install the version from the source as pypi does not allow repo/commit tags. Additionally, add the latest released version, currently `vk-api==11.9.9`. 
3. run `./scripts/release.sh` to create a tag and push, alternatively
   1. `git tag vx.y.z` to tag version
   2. `git push origin vx.y.z` -> this will trigger workflow and put project on [pypi](https://pypi.org/project/vk-url-scraper/)
4. go to https://readthedocs.org/ to deploy new docs version (if webhook is not setup)

### Fixing a failed release

If for some reason the GitHub Actions release workflow failed with an error that needs to be fixed, you'll have to delete both the tag and corresponding release from GitHub. After you've pushed a fix, delete the tag from your local clone with

```bash
git tag -l | xargs git tag -d && git fetch -t
```

Then repeat the steps above.
