import{b as T,Z as M,ab as G,i as A,G as x,o as m,c as k,w as e,a as o,f,N as J,I as L,R as p,t as y,e as O,Q as S,J as B,U as Q,_ as W}from"./index-8KTu6Yjm.js";import{_ as Z}from"./CreationForm-Cz44t7zv.js";import{_ as q,a as H}from"./ProviderGeneralForm-Cj-urgcx.js";import{_ as K}from"./MenuItems-26V-FboC.js";import{V as X}from"./VDataTable-wS0Z7qFU.js";import{V as I,a as Y}from"./VToolbar-etY1GidH.js";import{V as j}from"./VMenu-nE2mfhDs.js";import{h as N,i as E}from"./index-JekaRX8L.js";import{V as ee}from"./forwardRefs-Bzah7Mpr.js";import{V as R}from"./VSpacer-DyadbvqZ.js";import{V as oe}from"./VTextField-DfenxWrv.js";import{V as F}from"./VChip-D17pROGK.js";import{c as te}from"./VCard-D-oNwPin.js";import{V as ae}from"./VDialog-DQB8jCa6.js";import"./ConfirmDialog-DXzD-Pal.js";import"./VRow-DpmkUGHq.js";/* empty css              */import"./tag-CK_kS7XO.js";import"./VAvatar-CuprfBP1.js";import"./VWindowItem-u3qYZh_J.js";import"./ssrBoot-4XNgavEE.js";import"./VContainer-C_jYcOxR.js";import"./VSheet-iyhNAQVx.js";import"./dimensions-BC2DFC3e.js";import"./VAutocomplete-BfnHmHZq.js";import"./VSelect-BFp95bnL.js";import"./filter-au9RQdoW.js";import"./VForm-B6XZMar3.js";import"./VSwitch-Bg3X--SO.js";const re={__name:"ProviderCreationForm",emits:["close"],setup(D,{emit:r}){const l=r,{$gettext:s}=T(),u=M(),v=G(),U=A(()=>{const i=[];let n=!0;for(const V of a.value.domains){const z=V.new_domain?`${V.name} => ${V.new_domain.name}`:`${V.name} ${s("(the domain will be created locally)")}`;i.push({key:n?s("Associated domain"):"",value:z}),n=!1}return i}),b=A(()=>[{title:s("General"),items:[{key:s("Name"),value:a.value.name},{key:s("Address"),value:a.value.address},{key:s("Port"),value:a.value.port},{key:s("Secured"),value:a.value.secured,type:"yesno"}]},{title:s("Associated domains"),items:U.value}]),P=[{name:"general",title:s("General")},{name:"associated",title:s("Associated domains")}],a=x({domains:[]}),h=x(),$=x(),C={general:h,associated:$};w();function w(){a.value={name:"",address:"",port:993,secured:!0,domains:[]}}function d(){w(),l("close")}function c(i){return C.value[i.name]}function t(i){return console.log(a.value),C[i.name].value.vFormRef}function _(){}function g(){const i={...a.value};i.domains=[];for(const n of a.value.domains)n.new_domain?i.domains.push({name:n.name,new_domain:n.new_domain.pk}):i.domains.push(n);v.createProvider(i).then(()=>{u.displayNotification({msg:s("Provider created")}),d()})}return(i,n)=>(m(),k(f(Z),{ref:"form",title:f(s)("New provider"),steps:P,"form-getter":c,"get-v-form-ref":t,"validate-object":_,"summary-sections":b.value,onClose:d,onCreate:g},{"form.general":e(()=>[o(q,{ref_key:"general",ref:h,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=V=>a.value=V),class:"ml-4"},null,8,["modelValue"])]),"form.associated":e(()=>[o(H,{ref_key:"associated",ref:$,modelValue:a.value.domains,"onUpdate:modelValue":n[1]||(n[1]=V=>a.value.domains=V)},null,8,["modelValue"])]),_:2},1032,["title","summary-sections"]))}},se=["colspan"],ie={__name:"ProvidersList",setup(D){const{$gettext:r}=T(),l=G(),s=J(),u=A(()=>l.providers),v=A(()=>l.providersLoaded),U=[{title:r("Name"),key:"name"},{title:r("Address"),key:"address"},{title:r("Port"),key:"port"},{title:r("Secured"),key:"secured"},{title:r("Associated domains"),key:"domains"},{title:r("Actions"),key:"actions",sortable:!1,align:"right"}],b=x([]),P=x(""),a=x([]);function h(d){l.deleteProvider(d.id)}function $(d){s.push({name:"ProviderEdit",params:{id:d.id}})}function C(){const d=[];return d.push({label:r("Delete"),icon:"mdi-delete-outline",onClick:h,color:"red"}),d.push({label:r("Edit"),icon:"mdi-circle-edit-outline",onClick:$}),d}function w(){l.getProviders()}return v.value||w(),(d,c)=>(m(),k(te,{class:"mt-6"},{default:e(()=>[o(X,{modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=t=>b.value=t),expanded:a.value,"onUpdate:expanded":c[2]||(c[2]=t=>a.value=t),headers:U,items:Object.values(u.value),search:P.value,loading:!v.value,"item-value":"name","single-expand":"","show-select":"","onClick:row":c[3]||(c[3]=(t,_)=>_.expand(!_.isExpanded))},{top:e(()=>[o(I,{color:"white",flat:""},{default:e(()=>[o(j,{location:"bottom"},{activator:e(({props:t})=>[o(N,L(t,{variant:"flat","append-icon":"mdi-chevron-down",size:"small"}),{default:e(()=>[p(y(f(r)("Actions")),1)]),_:2},1040)]),default:e(()=>[o(ee,{density:"compact"})]),_:1}),o(N,{variant:"text",icon:"mdi-reload",onClick:w}),o(R),o(oe,{modelValue:P.value,"onUpdate:modelValue":c[0]||(c[0]=t=>P.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:f(r)("Search"),"single-line":"",variant:"outlined","hide-details":""},null,8,["modelValue","placeholder"])]),_:1})]),"item.secured":e(({item:t})=>[t.secured===!0?(m(),k(E,{key:0,color:"green"},{default:e(()=>[p(" mdi-lock ")]),_:1})):(m(),k(E,{key:1,color:"red"},{default:e(()=>[p(" mdi-lock-off ")]),_:1}))]),"item.domains":e(({item:t})=>[t.domains.length>0?(m(),k(F,{key:0},{default:e(()=>[p(y(t.domains.length)+" associated domain(s) ",1)]),_:2},1024)):(m(),k(F,{key:1},{default:e(()=>[p(" No associated domain ")]),_:1}))]),"expanded-item":e(({headers:t,item:_})=>[O("td",{colspan:t.length},[(m(!0),S(B,null,Q(_.domains,(g,i)=>(m(),k(F,{key:i},{default:e(()=>[g.new_domain?(m(),S(B,{key:0},[p(y(g.name)+" --> "+y(g.new_domain.name),1)],64)):(m(),S(B,{key:1},[p(y(g.name)+" --> "+y(g.name),1)],64))]),_:2},1024))),128))],8,se)]),"item.actions":e(({item:t})=>[o(j,{"offset-y":""},{activator:e(({props:_})=>[o(N,L({icon:"mdi-dots-horizontal",variant:"text"},_),null,16)]),default:e(()=>[o(f(K),{items:C(),obj:t},null,8,["items","obj"])]),_:2},1024)]),_:2},1032,["modelValue","expanded","items","search","loading"])]),_:1}))}},ne={__name:"ProvidersView",setup(D){const{$gettext:r}=T(),l=x(!1);return(s,u)=>(m(),S("div",null,[o(I,{flat:""},{default:e(()=>[o(Y,null,{default:e(()=>[p(y(f(r)("Providers")),1)]),_:1}),o(R),o(N,{color:"primary",variant:"flat","prepend-icon":"mdi-plus",onClick:u[0]||(u[0]=v=>l.value=!0)},{default:e(()=>[p(y(f(r)("New")),1)]),_:1})]),_:1}),o(f(ie)),o(ae,{modelValue:l.value,"onUpdate:modelValue":u[2]||(u[2]=v=>l.value=v),fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},{default:e(()=>[o(f(re),{onClose:u[1]||(u[1]=v=>l.value=!1)})]),_:1},8,["modelValue"])]))}},je=W(ne,[["__scopeId","data-v-1a3ee9c1"]]);export{je as default};
