import{_ as b}from"./Modoboa_RVB-BLANC-SANS-BbMFcwZs.js";import{u as k,g as F,b as S,h as n,o as u,c as m,w as t,a as e,e as y,t as c,f as o,i as T,j as A,k as C,l as V,m as B}from"./index-B6sfQZUh.js";import{V as D,r as I}from"./VForm-CVtiyeDB.js";import{a as g,V as f}from"./VRow-DllmF7yv.js";import{V as N}from"./VOtpInput-BARaY157.js";import{V as j,a as z}from"./VImg-AVVNtsoJ.js";import{V as R}from"./VContainer-D_MLw6yn.js";import"./tag-wMOM-gqO.js";import"./VField-Bhyg59H4.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-GMQTQL34.js";import"./dimensions-CKYnSDDa.js";import"./lazy-YEt_kfmk.js";const $={class:"text-primary mb-10 text-h4"},q={class:"text-body-2"},v={__name:"TwofaForm",setup(x){const r=k(),d=F(),{$gettext:s}=S(),i=n(!1),l=n(""),p=n();async function _(){const{valid:h}=await p.value.validate();h&&(i.value=!0,C.verifyTFACode(l.value).then(a=>{V.set("token",a.data.access,{sameSite:"strict"}),V.set("refreshToken",a.data.refresh,{sameSite:"strict"}),r.initialize().then(()=>{d.push({name:"DomainList"})})}).catch(()=>{i.value=!1}))}return(h,a)=>(u(),m(R,{class:"fill-height",fuild:""},{default:t(()=>[e(g,{align:"center",justify:"center",dense:""},{default:t(()=>[e(f,{cols:"12",sm:"10",md:"8",lg:"8",class:"text-center"},{default:t(()=>[y("h4",$,c(o(s)("Two-factor authentication")),1),e(D,{ref_key:"loginForm",ref:p,onSubmit:T(_,["prevent"])},{default:t(()=>[y("div",q,c(o(s)("Enter the code from the two-factor app on your mobile device. If you have lost your device, you may enter one of your recovery codes.")),1),e(N,{ref:"otpInput",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=w=>l.value=w),length:"6",rules:[o(I).required],onFinish:_},null,8,["modelValue","rules"]),e(j,{block:"",color:"primary",size:"large",type:"submit",loading:i.value,class:"mb-5"},{default:t(()=>[A(c(o(s)("Verify code")),1)]),_:1},8,["loading"])]),_:1},512)]),_:1})]),_:1})]),_:1}))}},Z={__name:"TwoFA",setup(x){const{smAndDown:r}=B();return(d,s)=>o(r)?(u(),m(v,{key:0})):(u(),m(g,{key:1,class:"fill-height ma-0"},{default:t(()=>[e(f,{class:"bg-primary"},{default:t(()=>[e(z,{src:b,"max-width":"300",class:"mt-10 ml-8"})]),_:1}),e(f,{class:"text-center"},{default:t(()=>[e(v)]),_:1})]),_:1}))}};export{Z as default};
