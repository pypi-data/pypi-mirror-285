import{d as U,V as F}from"./index-BqGCfcoz.js";import{ae as V,_ as N,b as G,a2 as Q,h,o as c,c as k,w as a,a as l,Q as L,j as n,t as m,f as g,X as x,R as D,e as X}from"./index-B6sfQZUh.js";import{_ as S}from"./MenuItems-DpSUv0fF.js";import{V as R,a as q}from"./VToolbar-i9pq53Nj.js";import{V as $}from"./VMenu-uuonQ6o9.js";import{V as E,i as H}from"./VImg-AVVNtsoJ.js";import{V as J}from"./VList-BoxPhnZ6.js";import{V as K}from"./VSpacer-BMAkDs-u.js";import{V as W}from"./VTextField-xrmh1FWy.js";import{V as M}from"./VChip-CRYOXnOA.js";import{c as Y}from"./VCard-CKOt35J8.js";import"./VDataTable-gjt2Fg5z.js";import"./tag-wMOM-gqO.js";import"./dimensions-CKYnSDDa.js";import"./VSelect-B9nLCGKh.js";import"./VField-Bhyg59H4.js";import"./forwardRefs-DWGaNmQL.js";import"./dialog-transition-InZxhk0f.js";import"./VOverlay-GMQTQL34.js";import"./lazy-YEt_kfmk.js";import"./VAvatar-xee8L3pJ.js";import"./filter-CcSZdtpY.js";import"./ssrBoot-CPdEBhNq.js";import"./createSimpleFunctional-BdzT111U.js";/* empty css              */const v="alarms",A={getAll(i){return V.get(`${v}/`,{params:i})},switchStatus(i,e){return V.patch(`${v}/${i}/switch/`,e)},delete(i){return V.delete(`${v}/${i}/`)},bulkDelete(i){return V.delete(`${v}/bulk_delete/`,{params:{ids:i}})}},Z=1,ee=2,y={ALARM_OPENED:Z,ALARM_CLOSED:ee},te={class:"text-right"},ae={__name:"AlarmList",setup(i){const{$gettext:e}=G(),d=Q(),w=h([]),b=h(!1),u=h(""),p=h([]),C=h(0),O=[{title:e("Triggered"),key:"created"},{title:e("Status"),key:"status"},{title:e("Domain"),key:"domain.name",sortable:!1},{title:e("Mailbox"),key:"mailbox",sortable:!1},{title:e("Message"),key:"title"},{title:e("Actions"),key:"actions",sortable:!1,align:"right"}];function T(){const o=[];return p.value.length>0&&o.push({label:e("Delete"),icon:"mdi-delete-outline",onClick:I,color:"red"}),o.push({label:e("Reload"),icon:"mdi-reload",onClick:r}),o}function z(o){const s=[];return s.push({label:e("Delete"),icon:"mdi-delete-outline",onClick:B,color:"red"}),o.status===y.ALARM_OPENED?s.push({label:e("Close alarm"),icon:"mdi-check",onClick:P,color:"green"}):s.push({label:e("Reopen alarm"),icon:"mdi-alert-circle-outline",onClick:j,color:"orange"}),s}function r({page:o,itemsPerPage:s,sortBy:t}){const f={page:o||1,page_size:s||10};t&&(f.ordering=t.map(_=>this.options.sortDesc[0]?`-${_}`:_).join(",")),u.value!==""&&(f.search=u.value),b.value=!0,A.getAll(f).then(_=>{w.value=_.data.results,C.value=_.data.count,b.value=!1})}async function B(o,s=!0){A.delete(o.id).then(()=>{s&&(d.displayNotification({msg:e("Alarm deleted")}),r({}))})}async function I(){await A.bulkDelete(p.value.map(o=>o.id)),d.displayNotification({msg:this.$gettext("Alarms deleted")}),p.value=[],r({})}async function P(o){A.switchStatus(o.id,{status:y.ALARM_CLOSED}).then(()=>{d.displayNotification({msg:e("Alarm closed")}),r({})})}async function j(o){A.switchStatus(o.id,{status:y.ALARM_OPENED}).then(()=>{d.displayNotification({msg:e("Alarm re-opened")}),r({})})}return r=U(r,500),(o,s)=>(c(),k(Y,{class:"mt-6"},{default:a(()=>[l(F,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),headers:O,items:w.value,search:u.value,"item-value":"id","items-length":C.value,loading:b.value,elevation:"0","show-select":"","onUpdate:options":r},{top:a(()=>[l(R,{color:"white",flat:""},{default:a(()=>[l($,{location:"bottom"},{activator:a(({props:t})=>[l(E,L(t,{size:"small"}),{default:a(()=>[n(m(g(e)("Actions"))+" ",1),l(H,{right:""},{default:a(()=>[n("mdi-chevron-down")]),_:1})]),_:2},1040)]),default:a(()=>[l(J,{density:"compact"},{default:a(()=>[l(g(S),{items:T()},null,8,["items"])]),_:1})]),_:1}),l(K),l(W,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:"Search",density:"compact",variant:"outlined","hide-details":"",flat:"","single-line":""},null,8,["modelValue"])]),_:1})]),"item.status":a(({item:t})=>[t.status===1?(c(),k(M,{key:0,color:"warning",size:"small"},{default:a(()=>[n(m(g(e)("Opened")),1)]),_:1})):(c(),k(M,{key:1,color:"info",size:"small"},{default:a(()=>[n(m(g(e)("Closed")),1)]),_:1}))]),"item.mailbox":a(({item:t})=>[t.mailbox?(c(),x(D,{key:0},[n(m(t.mailbox.address)+"@"+m(t.domain.name),1)],64)):(c(),x(D,{key:1},[n(" / ")],64))]),"item.created":a(({item:t})=>[n(m(o.$date(t.created)),1)]),"item.actions":a(({item:t})=>[X("div",te,[l($,{location:"bottom"},{activator:a(({props:f})=>[l(E,L({icon:"mdi-dots-horizontal"},f,{variant:"text"}),null,16)]),default:a(()=>[l(g(S),{items:z(t),obj:t},null,8,["items","obj"])]),_:2},1024)])]),_:2},1032,["modelValue","items","search","items-length","loading"])]),_:1}))}},oe=N(ae,[["__scopeId","data-v-29a64633"]]),le={__name:"AlarmsView",setup(i){return(e,d)=>(c(),x(D,null,[l(R,{flat:""},{default:a(()=>[l(q,null,{default:a(()=>[n(m(e.$gettext("Opened alarms")),1)]),_:1})]),_:1}),l(oe)],64))}},$e=N(le,[["__scopeId","data-v-d7e4ea18"]]);export{$e as default};
