import{_ as L,b as $,a6 as b,z as p,h as o,d as B,ay as F,az as T,S as U,o as v,X as g,a as y,Q as W,aA as N,w,R as k,Z as R,c as j,W as K,j as O,t as P,Y as G}from"./index-B6sfQZUh.js";import{V as Q}from"./VTextField-xrmh1FWy.js";import{a as X,b as Y,V as Z}from"./VList-BoxPhnZ6.js";const q={__name:"EmailField",props:{modelValue:{type:String,default:""},allowAdd:{type:Boolean,default:!1},role:{type:String,default:"SimpleUsers"},errorMsg:{type:Array,default:()=>[]}},emits:["domain-selected","update:model-value"],setup(D,{emit:A}){const{$gettext:C}=$(),h=b(),n=D,S=A,r=p({get(){return n.modelValue},set(e){u.value=[],e.indexOf("@")!==-1?n.role!=="SuperAdmins"?(i.value=e.split("@")[1],n.allowAdd?t.value=s.value.length>0:t.value=!0):u.value=[C("SuperAdmins cannot own a mailbox")]:t.value=!1,S("update:model-value",e)}}),s=p(()=>Object.values(h.domains).filter(e=>e.name.startsWith(i.value))),u=p({get(){return[..._.value,...n.errorMsg]},set(e){_.value=e}}),i=o(""),l=o(0),t=o(!1),V=o(500),x=o(),_=o([]);function E(e){if(n.role==="SuperAdmins")return;const a=e.keyCode;a===40||a===34?(t.value?M():(i.value="",t.value=!0),e.preventDefault()):a===38||a===33?(t.value?z():(i.value="",t.value=!0),e.preventDefault()):a===13||a===9?(s.value.length>0?c(s.value[l.value]):n.allowAdd&&c(),e.preventDefault()):a===27&&s.value.length>0&&(t.value=!1,e.preventDefault())}function M(){l.value>=s.value.length-1?l.value=0:l.value+=1}function z(){l.value<=0?l.value=s.value.length-1:l.value-=1}function c(e){e!==void 0&&(r.value=r.value.split("@")[0]+"@"+e.name),t.value=!1,S("domain-selected")}function m(){V.value=x.value.$el.clientWidth}return B(()=>{h.getDomains(),window.addEventListener("resize",m)}),F(()=>{window.removeEventListener("resize",m)}),T(()=>{U(()=>{m()})}),(e,a)=>(v(),g(k,null,[y(Q,W({ref_key:"inputRef",ref:x,modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=d=>r.value=d),variant:"outlined"},e.$attrs,{"error-messages":u.value,error:u.value.length>0,density:"compact",autocomplete:"new-password",onKeydown:E}),null,16,["modelValue","error-messages","error"]),t.value?(v(),g("div",{key:0,class:"menu",style:N(`width: ${V.value}px;`)},[y(Z,{class:"list"},{default:w(()=>[(v(!0),g(k,null,R(s.value,(d,f)=>(v(),j(X,{key:f,class:K(l.value===f?"bg-primary-lighten-1":""),onClick:I=>c(d),onMouseenter:I=>l.value=f},{default:w(()=>[y(Y,null,{default:w(()=>[O(P(d.name),1)]),_:2},1024)]),_:2},1032,["class","onClick","onMouseenter"]))),128))]),_:1})],4)):G("",!0)],64))}},te=L(q,[["__scopeId","data-v-f4a8114a"]]);export{te as E};
