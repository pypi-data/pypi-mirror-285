import{a2 as z,b as U,h as v,d as $,o as l,c as r,w as e,a as i,e as E,X as g,t as n,f as u,j as m,Y as _,ab as y,ad as G}from"./index-B6sfQZUh.js";import{V as H,a as I,b as L,c as O}from"./VCard-CKOt35J8.js";import{V as X}from"./VDataTableVirtual-B6834RoO.js";import{V as Y}from"./VAutocomplete-D7qVHjLV.js";import{V as h,i as C}from"./VImg-AVVNtsoJ.js";import{a as q,V as D}from"./VRow-DllmF7yv.js";const F={class:"headline"},J={key:0,class:"headline"},K={key:1,class:"headline"},P={key:0},ie={__name:"DomainAdminList",props:{domain:{type:Object,default:()=>{}},dialogMode:{type:Boolean,default:!1}},emits:["close"],setup(c,{emit:N}){const x=z(),{$gettext:a}=U(),f=c,M=N,p=v([]),k=v([]),w=v([{title:a("Username"),value:"username"},{title:a("Name"),value:"name"},{title:"",value:"actions",align:"end",sortable:!1}]),V=v(!1),s=v(null);function S(){k.value.push({}),V.value=!0}function T(){V.value=!1,M("close")}function A(o){y.getDomainAdministrators(o.pk).then(d=>{k.value=d.data})}function b(){G.getAll({role:"DomainAdmins"}).then(o=>{p.value=o.data.filter(d=>k.value.find(t=>t.id===d.pk)===void 0)})}function j(){y.addDomainAdministrator(f.domain.pk,s.value.pk).then(()=>{A(f.domain),p.value=p.value.filter(o=>o.pk!==s.value.pk),s.value=null,V.value=!1,x.displayNotification({msg:a("Administrator added")})})}function R(o){y.removeDomainAdministrator(f.domain.pk,o.id).then(()=>{A(f.domain),b(),x.displayNotification({msg:a("Administrator removed")})})}return $(()=>{A(f.domain),b()}),(o,d)=>(l(),r(O,null,{default:e(()=>[i(H,null,{default:e(()=>[E("span",F,[c.dialogMode?(l(),g("div",J,n(u(a)("Administrators of"))+" "+n(c.domain.name),1)):(l(),g("div",K,n(u(a)("Administrators")),1))])]),_:1}),i(I,null,{default:e(()=>[i(X,{headers:w.value,items:k.value},{"item.username":e(({item:t})=>[t.id?(l(),g("span",P,n(t.username),1)):(l(),r(Y,{key:1,modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=B=>s.value=B),label:u(a)("Select an account"),items:p.value,"item-title":"username",class:"mt-5","return-object":""},{append:e(()=>[s.value?(l(),r(h,{key:0,variant:"text",color:"primary",size:"x-large",onClick:j},{default:e(()=>[i(C,null,{default:e(()=>[m("mdi-content-save")]),_:1})]),_:1})):_("",!0)]),_:1},8,["modelValue","label","items"]))]),"item.name":e(({item:t})=>[m(n(t.first_name)+" "+n(t.last_name),1)]),"item.actions":e(({item:t})=>[t.id?(l(),r(h,{key:0,variant:"text",color:"red",title:u(a)("Remove this administrator"),size:"x-large",onClick:B=>R(t)},{default:e(()=>[i(C,null,{default:e(()=>[m("mdi-delete-outline")]),_:1})]),_:2},1032,["title","onClick"])):_("",!0)]),_:2},1032,["headers","items"])]),_:1}),i(L,null,{default:e(()=>[i(q,null,{default:e(()=>[i(D,{align:c.dialogMode?"left":"right"},{default:e(()=>[V.value?_("",!0):(l(),r(h,{key:0,color:"primary",variant:"outlined",onClick:S},{default:e(()=>[i(C,{small:""},{default:e(()=>[m("mdi-plus")]),_:1}),m(" "+n(u(a)("Add administrator")),1)]),_:1}))]),_:1},8,["align"]),c.dialogMode?(l(),r(D,{key:0,align:"right"},{default:e(()=>[i(h,{color:"grey darken-1",variant:"text",onClick:T},{default:e(()=>[m(n(u(a)("Close")),1)]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1}))}};export{ie as _};
