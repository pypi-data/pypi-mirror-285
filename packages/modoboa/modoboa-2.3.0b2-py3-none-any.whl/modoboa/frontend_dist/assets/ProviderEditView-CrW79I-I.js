import{b as N,a2 as C,g as T,af as j,h as c,B as U,o as i,X as g,a,w as e,j as u,t as n,f as d,c as V,e as k,R as A,ag as R,q as G}from"./index-B6sfQZUh.js";import{_ as q,a as D}from"./ProviderGeneralForm-D5552fXZ.js";import{w as $,V as b}from"./VImg-AVVNtsoJ.js";import{V as E,c as F,a as B,b as L}from"./VExpansionPanels-CVe8KlbO.js";import{a as y,V as m}from"./VRow-DllmF7yv.js";import"./VTextField-xrmh1FWy.js";import"./tag-wMOM-gqO.js";import"./VField-Bhyg59H4.js";import"./forwardRefs-DWGaNmQL.js";import"./dimensions-CKYnSDDa.js";import"./VAutocomplete-D7qVHjLV.js";import"./VSelect-B9nLCGKh.js";import"./VList-BoxPhnZ6.js";import"./ssrBoot-CPdEBhNq.js";import"./createSimpleFunctional-BdzT111U.js";import"./VAvatar-xee8L3pJ.js";import"./dialog-transition-InZxhk0f.js";import"./VMenu-uuonQ6o9.js";import"./VOverlay-GMQTQL34.js";import"./lazy-YEt_kfmk.js";import"./VChip-CRYOXnOA.js";import"./filter-CcSZdtpY.js";import"./VForm-CVtiyeDB.js";import"./VSpacer-BMAkDs-u.js";/* empty css              */import"./VSwitch-Bvl549Dr.js";const O={key:0},X={key:0},z={class:"mt-4 d-flex justify-end"},H={__name:"ProviderForm",props:{provider:{type:Object,default:null}},setup(w){const x=w,{$gettext:r}=N(),v=C(),_=T(),h=j(),s=c({domains:[]}),P=c(0),p=c(),f=c();U(()=>x.provider,t=>{t&&(s.value={...t},s.value.domains||(s.value.domains=[]))},{immediate:!0});async function S(){if(p.value!==void 0){const{valid:t}=await p.value.vFormRef.validate();if(!t)return}if(f.value!==void 0){const{valid:t}=await f.value.vFormRef.validate();if(!t)return}try{const t={...s.value};t.domains=[];for(const o of s.value.domains)o.new_domain?t.domains.push({name:o.name,new_domain:o.new_domain.pk||o.new_domain.id}):t.domains.push(o);await R.patchProvider(s.value.id,t).then(()=>{v.displayNotification({msg:r("Provider updated")}),h.getProviders(),_.push({name:"ProvidersList"})})}catch(t){p.value&&p.value.$refs.observer.setErrors(t.response.data),f.value&&f.value.$refs.observer.setErrors(t.response.data)}}return(t,o)=>(i(),g(A,null,[a(L,{modelValue:P.value,"onUpdate:modelValue":o[2]||(o[2]=l=>P.value=l)},{default:e(()=>[a(E,null,{default:e(()=>[a(F,null,{default:e(({open:l})=>[a(y,{"no-gutters":""},{default:e(()=>[a(m,{cols:"4"},{default:e(()=>[u(n(d(r)("General")),1)]),_:1}),a(m,{cols:"8",class:"text-secondary"},{default:e(()=>[a($,{"leave-absolute":""},{default:e(()=>[l?(i(),g("span",O)):(i(),V(y,{key:1,"no-gutters":"",style:{width:"100%"}},{default:e(()=>[a(m,{cols:"6"},{default:e(()=>[u(n(d(r)("Name:"))+" "+n(s.value.name),1)]),_:1})]),_:1}))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),a(B,null,{default:e(()=>[a(q,{ref_key:"generalForm",ref:p,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value=l)},null,8,["modelValue"])]),_:1})]),_:1}),a(E,null,{default:e(()=>[a(F,null,{default:e(({open:l})=>[a(y,{"no-gutters":""},{default:e(()=>[a(m,{cols:"4"},{default:e(()=>[u(n(d(r)("Associated domains")),1)]),_:1}),a(m,{cols:"8",class:"text-secondary"},{default:e(()=>[a($,{"leave-absolute":""},{default:e(()=>[l?(i(),g("span",X)):(i(),V(y,{key:1,"no-gutters":"",style:{width:"100%"}},{default:e(()=>[s.value.domains.length>0?(i(),V(m,{key:0,cols:"6"},{default:e(()=>[u(n(d(r)("Number of associated domains:"))+" "+n(s.value.domains.length),1)]),_:1})):(i(),V(m,{key:1,cols:"6"},{default:e(()=>[u(n(d(r)("No associated domains")),1)]),_:1}))]),_:1}))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),a(B,null,{default:e(()=>[a(D,{ref_key:"associatedForm",ref:f,modelValue:s.value.domains,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.domains=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),k("div",z,[a(b,{onClick:o[3]||(o[3]=l=>t.$router.go(-1))},{default:e(()=>[u(n(d(r)("Cancel")),1)]),_:1}),a(b,{class:"ml-4",color:"primary darken-1",onClick:S},{default:e(()=>[u(n(d(r)("Save")),1)]),_:1})])],64))}},I={class:"text-h4"},J=k("div",{class:"mt-4"},null,-1),xe={__name:"ProviderEditView",setup(w){const{$gettext:x}=N(),r=G(),v=c({});return R.getProvider(r.params.id).then(_=>{v.value=_.data}),(_,h)=>(i(),g("div",null,[k("span",I,n(d(x)("Edit provider")),1),J,a(H,{provider:v.value},null,8,["provider"])]))}};export{xe as default};
