import{b as U,a2 as M,af as E,z as A,h as x,o as m,c as k,w as e,a as o,f,g as O,Q as D,j as p,t as g,e as Q,X as S,R as F,Z as W,_ as X}from"./index-B6sfQZUh.js";import{_ as Z}from"./CreationForm-v6mZNUNT.js";import{_ as q,a as H}from"./ProviderGeneralForm-D5552fXZ.js";import{_ as J}from"./MenuItems-DpSUv0fF.js";import{V as K}from"./VDataTable-gjt2Fg5z.js";import{V as R,a as Y}from"./VToolbar-i9pq53Nj.js";import{V as L}from"./VMenu-uuonQ6o9.js";import{V as N,i as z}from"./VImg-AVVNtsoJ.js";import{V as ee}from"./VList-BoxPhnZ6.js";import{V as G}from"./VSpacer-BMAkDs-u.js";import{V as oe}from"./VTextField-xrmh1FWy.js";import{V as T}from"./VChip-CRYOXnOA.js";import{c as te}from"./VCard-CKOt35J8.js";import{V as ae}from"./VDialog-n5-nWTx5.js";import"./ConfirmDialog-CB9bATIP.js";import"./VRow-DllmF7yv.js";/* empty css              */import"./tag-wMOM-gqO.js";import"./createSimpleFunctional-BdzT111U.js";import"./VAvatar-xee8L3pJ.js";import"./VWindowItem-d1FqDlD3.js";import"./lazy-YEt_kfmk.js";import"./ssrBoot-CPdEBhNq.js";import"./VContainer-D_MLw6yn.js";import"./VSheet-UF7FAefD.js";import"./dimensions-CKYnSDDa.js";import"./VAutocomplete-D7qVHjLV.js";import"./VSelect-B9nLCGKh.js";import"./VField-Bhyg59H4.js";import"./forwardRefs-DWGaNmQL.js";import"./dialog-transition-InZxhk0f.js";import"./VOverlay-GMQTQL34.js";import"./filter-CcSZdtpY.js";import"./VForm-CVtiyeDB.js";import"./VSwitch-Bvl549Dr.js";const re={__name:"ProviderCreationForm",emits:["close"],setup(j,{emit:r}){const l=r,{$gettext:s}=U(),u=M(),v=E(),B=A(()=>{const i=[];let n=!0;for(const V of a.value.domains){const I=V.new_domain?`${V.name} => ${V.new_domain.name}`:`${V.name} ${s("(the domain will be created locally)")}`;i.push({key:n?s("Associated domain"):"",value:I}),n=!1}return i}),b=A(()=>[{title:s("General"),items:[{key:s("Name"),value:a.value.name},{key:s("Address"),value:a.value.address},{key:s("Port"),value:a.value.port},{key:s("Secured"),value:a.value.secured,type:"yesno"}]},{title:s("Associated domains"),items:B.value}]),P=[{name:"general",title:s("General")},{name:"associated",title:s("Associated domains")}],a=x({domains:[]}),h=x(),$=x(),C={general:h,associated:$};w();function w(){a.value={name:"",address:"",port:993,secured:!0,domains:[]}}function d(){w(),l("close")}function c(i){return C.value[i.name]}function t(i){return console.log(a.value),C[i.name].value.vFormRef}function _(){}function y(){const i={...a.value};i.domains=[];for(const n of a.value.domains)n.new_domain?i.domains.push({name:n.name,new_domain:n.new_domain.pk}):i.domains.push(n);v.createProvider(i).then(()=>{u.displayNotification({msg:s("Provider created")}),d()})}return(i,n)=>(m(),k(f(Z),{ref:"form",title:f(s)("New provider"),steps:P,"form-getter":c,"get-v-form-ref":t,"validate-object":_,"summary-sections":b.value,onClose:d,onCreate:y},{"form.general":e(()=>[o(q,{ref_key:"general",ref:h,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=V=>a.value=V),class:"ml-4"},null,8,["modelValue"])]),"form.associated":e(()=>[o(H,{ref_key:"associated",ref:$,modelValue:a.value.domains,"onUpdate:modelValue":n[1]||(n[1]=V=>a.value.domains=V)},null,8,["modelValue"])]),_:2},1032,["title","summary-sections"]))}},se=["colspan"],ie={__name:"ProvidersList",setup(j){const{$gettext:r}=U(),l=E(),s=O(),u=A(()=>l.providers),v=A(()=>l.providersLoaded),B=[{title:r("Name"),key:"name"},{title:r("Address"),key:"address"},{title:r("Port"),key:"port"},{title:r("Secured"),key:"secured"},{title:r("Associated domains"),key:"domains"},{title:r("Actions"),key:"actions",sortable:!1,align:"right"}],b=x([]),P=x(""),a=x([]);function h(d){l.deleteProvider(d.id)}function $(d){s.push({name:"ProviderEdit",params:{id:d.id}})}function C(){const d=[];return d.push({label:r("Delete"),icon:"mdi-delete-outline",onClick:h,color:"red"}),d.push({label:r("Edit"),icon:"mdi-circle-edit-outline",onClick:$}),d}function w(){l.getProviders()}return v.value||w(),(d,c)=>(m(),k(te,{class:"mt-6"},{default:e(()=>[o(K,{modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=t=>b.value=t),expanded:a.value,"onUpdate:expanded":c[2]||(c[2]=t=>a.value=t),headers:B,items:Object.values(u.value),search:P.value,loading:!v.value,"item-value":"name","single-expand":"","show-select":"","onClick:row":c[3]||(c[3]=(t,_)=>_.expand(!_.isExpanded))},{top:e(()=>[o(R,{color:"white",flat:""},{default:e(()=>[o(L,{location:"bottom"},{activator:e(({props:t})=>[o(N,D(t,{variant:"flat","append-icon":"mdi-chevron-down",size:"small"}),{default:e(()=>[p(g(f(r)("Actions")),1)]),_:2},1040)]),default:e(()=>[o(ee,{density:"compact"})]),_:1}),o(N,{variant:"text",icon:"mdi-reload",onClick:w}),o(G),o(oe,{modelValue:P.value,"onUpdate:modelValue":c[0]||(c[0]=t=>P.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:f(r)("Search"),"single-line":"",variant:"outlined","hide-details":""},null,8,["modelValue","placeholder"])]),_:1})]),"item.secured":e(({item:t})=>[t.secured===!0?(m(),k(z,{key:0,color:"green"},{default:e(()=>[p(" mdi-lock ")]),_:1})):(m(),k(z,{key:1,color:"red"},{default:e(()=>[p(" mdi-lock-off ")]),_:1}))]),"item.domains":e(({item:t})=>[t.domains.length>0?(m(),k(T,{key:0},{default:e(()=>[p(g(t.domains.length)+" associated domain(s) ",1)]),_:2},1024)):(m(),k(T,{key:1},{default:e(()=>[p(" No associated domain ")]),_:1}))]),"expanded-item":e(({headers:t,item:_})=>[Q("td",{colspan:t.length},[(m(!0),S(F,null,W(_.domains,(y,i)=>(m(),k(T,{key:i},{default:e(()=>[y.new_domain?(m(),S(F,{key:0},[p(g(y.name)+" --> "+g(y.new_domain.name),1)],64)):(m(),S(F,{key:1},[p(g(y.name)+" --> "+g(y.name),1)],64))]),_:2},1024))),128))],8,se)]),"item.actions":e(({item:t})=>[o(L,{"offset-y":""},{activator:e(({props:_})=>[o(N,D({icon:"mdi-dots-horizontal",variant:"text"},_),null,16)]),default:e(()=>[o(f(J),{items:C(),obj:t},null,8,["items","obj"])]),_:2},1024)]),_:2},1032,["modelValue","expanded","items","search","loading"])]),_:1}))}},ne={__name:"ProvidersView",setup(j){const{$gettext:r}=U(),l=x(!1);return(s,u)=>(m(),S("div",null,[o(R,{flat:""},{default:e(()=>[o(Y,null,{default:e(()=>[p(g(f(r)("Providers")),1)]),_:1}),o(G),o(N,{color:"primary",variant:"flat","prepend-icon":"mdi-plus",onClick:u[0]||(u[0]=v=>l.value=!0)},{default:e(()=>[p(g(f(r)("New")),1)]),_:1})]),_:1}),o(f(ie)),o(ae,{modelValue:l.value,"onUpdate:modelValue":u[2]||(u[2]=v=>l.value=v),fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},{default:e(()=>[o(f(re),{onClose:u[1]||(u[1]=v=>l.value=!1)})]),_:1},8,["modelValue"])]))}},Me=X(ne,[["__scopeId","data-v-1a3ee9c1"]]);export{Me as default};
