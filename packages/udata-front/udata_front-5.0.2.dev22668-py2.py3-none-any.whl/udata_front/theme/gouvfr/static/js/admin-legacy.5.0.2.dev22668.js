System.register(["vue","./sentry-legacy.5.0.2.dev22668.js","./_commonjsHelpers-legacy.5.0.2.dev22668.js"],(function(e,r){"use strict";var a,l,t,o,n,i,s,d,u,c,f,m,b,v,g,p,_,h,y,w,k,z,x,A,C,M,R,q,B,S,V,T,E,P,U,I,O,H,$,D,j,N,L,Y,W,F,J,Z,G,K,Q,X,ee,re,ae,le,te,oe,ne,ie,se,de,ue,ce;return{setters:[e=>{a=e.defineComponent,l=e.resolveComponent,t=e.openBlock,o=e.createElementBlock,n=e.createElementVNode,i=e.normalizeClass,s=e.createCommentVNode,d=e.createVNode,u=e.withCtx,c=e.createTextVNode,f=e.toDisplayString,m=e.unref,b=e.ref,v=e.onMounted,g=e.Fragment,p=e.renderList,_=e.createBlock,h=e.renderSlot,y=e.watchEffect,w=e.computed,k=e.Teleport,z=e.withModifiers,x=e.createApp},e=>{A=e._,C=e.c,M=e.i,R=e.B,q=e.aC,B=e.ai,S=e.e,V=e.a,T=e.j,E=e.ag,P=e.aD,U=e.aE,I=e.d,O=e.F,H=e.a8,$=e.M,D=e.aF,j=e.V,N=e.aG,L=e.aH,Y=e.aI,W=e.aJ,F=e.aK,J=e.aL,Z=e.aM,G=e.aN,K=e.an,Q=e.aO,X=e.aP,ee=e.as,re=e.ao,ae=e.av,le=e.aw,te=e.ah,oe=e.ax,ne=e.U,ie=e.aQ,se=e.aR,de=e.ay,ue=e.az,ce=e.aA},null],execute:function(){var e=document.createElement("style");e.textContent=".fr-sidemenu__link[data-v-6240fbee]{padding:.25rem .375rem}.fr-sidemenu__link[aria-current][data-v-6240fbee]:before{width:0}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]){border-radius:2px;background-color:var(--background-alt-grey);color:var(--text-default-grey);font-weight:800}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]):hover{background-color:var(--background-alt-grey-hover)}.fr-sidemenu__link[data-v-6240fbee]:has(>[aria-current]):active{background-color:var(--background-alt-grey-active)}.fr-sidemenu__btn[data-v-02c4027f]{background-color:var(--background-alt-grey);border-bottom:1px solid var(--border-default-grey)}.fr-sidemenu__btn[data-v-02c4027f]:hover{background-color:var(--background-alt-grey-hover)}.fr-sidemenu__btn[data-v-02c4027f]:active{background-color:var(--background-alt-grey-active)}.fr-sidemenu__btn[aria-current][data-v-02c4027f]{background-color:var(--background-default-grey);color:var(--text-default-grey)}.fr-sidemenu__btn[aria-current][data-v-02c4027f]:before{width:0}.fr-sidemenu__btn[aria-current][data-v-02c4027f]:hover{background-color:var(--hover-tint)}.fr-sidemenu__btn[aria-current][data-v-02c4027f]:active{background-color:var(--active-tint)}html,body{height:100%}#app{display:flex;flex-direction:column;height:100%}.fr-sidemenu .fr-sidemenu__item:first-child:before,.fr-sidemenu .fr-sidemenu__item:last-child:before,.fr-sidemenu .fr-sidemenu__item:before{box-shadow:none}.fr-sidemenu[data-v-288c086e]{padding:0}.fr-sidemenu .fr-sidemenu__inner[data-v-288c086e]{padding:0;box-shadow:1px 0 0 0 var(--border-default-grey);background-color:var(--grey-1000-50)}@media (min-width: 48em){.fr-sidemenu[data-v-288c086e],.fr-sidemenu__inner[data-v-288c086e]{height:100%}}\n",document.head.appendChild(e);const r={class:"fr-sidemenu__item"},fe=["innerHTML"],me=A(a({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup:e=>(e,a)=>{const m=l("router-link");return t(),o("li",r,[n("div",{class:i([{"fr-icon-svg fr-icon--sm":e.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[e.iconHtml?(t(),o("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:e.iconHtml},null,8,fe)):e.icon?(t(),o("div",{key:1,class:i([e.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):s("",!0),d(m,{to:e.to},{default:u((()=>[c(f(e.label),1)])),_:1},8,["to"])],2)])}}),[["__scopeId","data-v-6240fbee"]]),be=["aria-expanded","aria-controls","aria-current"],ve={class:"logo logo--sm"},ge={class:"fr-mx-1w fr-col text-overflow-ellipsis"},pe=["id"],_e={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},he=a({__name:"AdminSidebarOrganizationMenu",props:{organization:{},isOpened:{type:Boolean}},setup(e){const{t:r}=C(),a=M("organization-menu");return(e,l)=>(t(),o("li",{class:i(["fr-sidemenu__item",{"fr-sidemenu__item--active":e.isOpened}])},[n("button",{class:"fr-sidemenu__btn","aria-expanded":e.isOpened,"aria-controls":m(a),"aria-current":e.isOpened},[n("div",ve,[d(R,{type:"organization",src:e.organization.logo_thumbnail,size:20},null,8,["src"])]),n("p",ge,f(e.organization.name),1)],8,be),n("div",{class:"fr-collapse","data-fr-js-collapse":"",id:m(a)},[n("ul",_e,[d(me,{iconHtml:m('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'),label:m(r)("Datasets"),to:{name:"organization-datasets",params:{oid:e.organization.id}}},null,8,["iconHtml","label","to"]),d(me,{icon:"fr-icon-line-chart-line",label:m(r)("Reuses"),to:{name:"organization-reuses",params:{oid:e.organization.id}}},null,8,["label","to"]),d(me,{icon:"fr-icon-parent-line",label:m(r)("Members"),to:{name:"organization-members",params:{oid:e.organization.id}}},null,8,["label","to"]),d(me,{icon:"fr-icon-user-line",label:m(r)("Profile"),to:{name:"organization-profile",params:{oid:e.organization.id}}},null,8,["label","to"])])],8,pe)],2))}}),ye=A(he,[["__scopeId","data-v-02c4027f"]]),we={class:"fr-container--fluid h-100"},ke={class:"fr-grid-row h-100 bg-grey-50"},ze={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},xe=["aria-label"],Ae={class:"fr-sidemenu__inner"},Ce=["aria-controls"],Me=["id"],Re={class:"fr-sidemenu__list"},qe={class:"fr-sidemenu__item"},Be=["aria-controls"],Se={class:"fr-mx-1v"},Ve=["id"],Te={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w"},Ee=A(a({__name:"Admin",setup(e){const{t:r}=C(),a=q(),i=M("menu"),u=M("profil-submenu"),c=b(null),h=b(null);return v((async()=>{c.value=await B(),c.value.organizations.length>0&&(a.params.oid?h.value=a.params.oid:h.value=c.value.organizations[0].id)})),(e,b)=>{const v=l("router-view");return t(),o("div",we,[n("div",ke,[n("div",ze,[n("nav",{class:"fr-sidemenu","aria-label":m(r)("Administration menu")},[n("div",Ae,[n("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":m(i),"aria-expanded":"false"},f(m(r)("Open menu")),9,Ce),n("div",{class:"fr-collapse",id:m(i)},[n("ul",Re,[n("li",qe,[n("button",{class:"fr-sidemenu__btn border-bottom border-default-grey","aria-expanded":"false","aria-controls":m(u)},[d(S,{user:m(V),size:24,rounded:!0},null,8,["user"]),n("p",Se,f(m(r)("My Profil")),1)],8,Be),n("div",{class:"fr-collapse",id:m(u)},[d(me,{icon:"fr-icon-account-circle-line",label:m(r)("Me"),to:"/me"},null,8,["label"])],8,Ve)]),c.value?(t(!0),o(g,{key:0},p(c.value.organizations,(e=>{return t(),_(ye,{organization:e,"is-opened":(r=e.id,r===h.value)},null,8,["organization","is-opened"]);var r})),256)):s("",!0)])],8,Me)])],8,xe)]),n("div",Te,[(t(),_(v,{key:m(a).fullPath}))])])])}}}),[["__scopeId","data-v-288c086e"]]),Pe=["aria-label"],Ue={class:"fr-breadcrumb__list"},Ie={__name:"Breadcrumb",setup(e){const{t:r}=C();return(e,a)=>(t(),o("nav",{rol:"navigation","aria-label":m(r)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[n("ol",Ue,[h(e.$slots,"default")])],8,Pe))}},Oe={class:"fr-container--fluid"},He={key:0},$e={class:"fr-breadcrumb__link","aria-current":"page"},De={class:"fr-alert fr-alert--info"},je={class:"fr-alert__title"},Ne=a({__name:"Datasets",props:{oid:{}},setup(e){const{t:r}=C(),a=e,i=`/admin/organization/${a.oid}/`,g=b(null),p=b(null);return v((async()=>g.value=await B())),y((()=>{var e,r;p.value=null!==(e=null===(r=g.value)||void 0===r?void 0:r.organizations.find((e=>e.id===a.oid)))&&void 0!==e?e:null})),(e,a)=>{const b=l("router-link");return t(),o("div",Oe,[d(Ie,null,{default:u((()=>[n("li",null,[d(b,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(m(r)("Administration")),1)])),_:1})]),p.value?(t(),o("li",He,[d(b,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(p.value.name),1)])),_:1})])):s("",!0),n("li",null,[n("a",$e,f(m(r)("Datasets")),1)])])),_:1}),n("div",De,[n("h3",je,f(m(r)("This is a WIP page")),1),n("p",null,[n("a",{href:i},f(m(r)("You can manage your datasets on the current admin.")),1)])])])}}}),Le={class:"fr-container--fluid"},Ye={key:0},We={class:"fr-breadcrumb__link","aria-current":"page"},Fe={class:"fr-alert fr-alert--info"},Je={class:"fr-alert__title"},Ze=a({__name:"Reuses",props:{oid:{}},setup(e){const{t:r}=C(),a=e,i=`/admin/organization/${a.oid}/`,g=b(null),p=b(null);return v((async()=>g.value=await B())),y((()=>{var e,r;p.value=null!==(e=null===(r=g.value)||void 0===r?void 0:r.organizations.find((e=>e.id===a.oid)))&&void 0!==e?e:null})),(e,a)=>{const b=l("router-link");return t(),o("div",Le,[d(Ie,null,{default:u((()=>[n("li",null,[d(b,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(m(r)("Administration")),1)])),_:1})]),p.value?(t(),o("li",Ye,[d(b,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(p.value.name),1)])),_:1})])):s("",!0),n("li",null,[n("a",We,f(m(r)("Reuses")),1)])])),_:1}),n("div",Fe,[n("h3",Je,f(m(r)("This is a WIP page")),1),n("p",null,[n("a",{href:i},f(m(r)("You can manage your reuses on the current admin.")),1)])])])}}}),Ge={class:"fr-container--fluid"},Ke={class:"fr-breadcrumb__link","aria-current":"page"},Qe={key:0,class:"fr-h1"},Xe={class:"fr-alert fr-alert--info"},er={class:"fr-alert__title"},rr={href:"/admin/me/"},ar=a({__name:"Me",setup(e){const{t:r}=C(),a=b(null);return v((async()=>a.value=await B())),(e,i)=>{const b=l("router-link");return t(),o("div",Ge,[d(Ie,null,{default:u((()=>[n("li",null,[d(b,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(m(r)("Administration")),1)])),_:1})]),n("li",null,[n("a",Ke,f(m(r)("Me")),1)])])),_:1}),a.value?(t(),o("h1",Qe,f(a.value.first_name)+" "+f(a.value.last_name),1)):s("",!0),n("div",Xe,[n("h3",er,f(m(r)("This is a WIP page")),1),n("p",null,[n("a",rr,f(m(r)("You can edit your profil on the current admin.")),1)])])])}}}),lr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},tr=a({__name:"AdminDangerZone",setup:e=>(e,r)=>(t(),_(m(T),{color:"error",type:"secondary",weight:"regular"},{default:u((()=>[n("div",lr,[h(e.$slots,"default")])])),_:3}))}),or=["aria-labelledby","id"],nr={class:"fr-container fr-container--fluid fr-container-md"},ir={class:"fr-grid-row fr-grid-row--center"},sr={class:"fr-col-12 fr-col-md-8"},dr={class:"fr-modal__body"},ur={class:"fr-modal__header"},cr=["title","aria-controls"],fr={class:"fr-modal__content"},mr=["id"],br={class:"fr-grid-row fr-grid-row--middle fr-text--bold fr-mb-2w"},vr={class:"fr-col"},gr={class:"fr-col-auto"},pr=["disabled"],_r={class:"fr-col"},hr={class:"fr-m-0 text-grey-500"},yr={class:"fr-m-0 fr-text--xs text-default-error"},wr={class:"fr-col-auto"},kr=["disabled"],zr=a({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e,{emit:r}){const a=e,l=r,o=w((()=>"fr-modal-title-user-"+a.id)),{t:i}=C(),{toast:v}=I(),g=b(!1);function p(){g.value=!1;const e=document.getElementById(a.id);globalThis.dsfr(e).modal.conceal()}return(e,r)=>{return t(),_(k,{to:"body"},[n("dialog",{"aria-labelledby":o.value,role:"dialog",id:e.id,class:"fr-modal"},[n("div",nr,[n("div",ir,[n("div",sr,[n("div",dr,[n("div",ur,[n("button",{class:"fr-btn--close fr-btn",title:m(i)("Close the modal dialog"),"aria-controls":e.id},f(m(i)("Close")),9,cr)]),n("div",fr,[n("h1",{id:o.value,class:"fr-modal__title fr-mb-2w"},f(m(i)("Edit member")),9,mr),n("p",br,[d(S,{class:"fr-mr-1v",user:e.member.user,rounded:!0,size:24},null,8,["user"]),c(" "+f(e.member.user.first_name)+" "+f(e.member.user.last_name),1)]),n("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:r[1]||(r[1]=z((r=>async function(e){if(e.newRole)try{g.value=!0,await P(a.oid,e.user.id,e.newRole),l("memberUpdated"),p()}catch(r){v.error(i("An error occurred while update member role."))}finally{g.value=!1}else p()}(e.member)),["prevent"]))},[n("div",vr,[e.roles.length>0?(t(),_(E,{key:0,label:m(i)("Role of the member"),"model-value":e.member.role,"onUpdate:modelValue":r[0]||(r[0]=r=>e.member.newRole=r),options:(b=e.member.role,a.roles.map((e=>{const r={...e};return r.value===b&&(r.selected=!0),r})))},null,8,["label","model-value","options"])):s("",!0)]),n("div",gr,[n("button",{class:"fr-btn",type:"submit",disabled:g.value},f(m(i)("Validate")),9,pr)])],32),d(tr,{class:"fr-mt-2w"},{default:u((()=>[n("div",_r,[n("p",hr,f(m(i)("Remove member from the organization")),1),n("p",yr,f(m(i)("Be careful, this action can't be reverse.")),1)]),n("div",wr,[n("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:g.value,onClick:r[2]||(r[2]=r=>async function(e){try{g.value=!0,await U(a.oid,e.user.id),l("memberUpdated")}catch(r){v.error(i("An error occurred while removing this member."))}finally{g.value=!1}}(e.member))},f(m(i)("Remove member")),9,kr)])])),_:1})])])])])])],8,or)]);var b}}}),xr=["aria-controls"],Ar=a({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e){const r=e,{t:a}=C(),l=w((()=>"fr-modal-user-"+r.member.user.id));return(e,r)=>(t(),o(g,null,[n("button",{class:"fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":l.value},f(m(a)("Edit")),9,xr),d(zr,{id:l.value,member:e.member,oid:e.oid,roles:e.roles,onMemberUpdated:r[0]||(r[0]=r=>e.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),Cr={class:"fr-mt-n9v fr-mb-2w"},Mr={class:"fr-badge fr-badge--info fr-badge--no-icon"},Rr=n("span",{class:"fr-icon-user-add-line","aria-hidden":"true"},null,-1),qr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Br={class:"fr-col"},Sr={class:"fr-grid-row fr-grid-row--middle"},Vr={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},Tr={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},Er=["disabled"],Pr=["disabled","aria-controls"],Ur=["aria-labelledby","id"],Ir={class:"fr-container fr-container--fluid fr-container-md"},Or={class:"fr-grid-row fr-grid-row--center"},Hr={class:"fr-col-12 fr-col-md-8"},$r={class:"fr-modal__body"},Dr={class:"fr-modal__header"},jr=["title","aria-controls"],Nr={class:"fr-modal__content"},Lr=["id"],Yr={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},Wr={class:"fr-col-auto"},Fr=["disabled"],Jr={class:"fr-col-auto"},Zr=["disabled"],Gr=a({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(e,{emit:r}){const a=e,i=r,{t:v}=C(),g=b(""),p=M("modal"),h=M("modalTitle");function y(){const e=document.getElementById(p);globalThis.dsfr(e).modal.conceal()}function w(){i("refuse",a.request.id,g.value),y()}function x(){g.value="",y()}return(e,r)=>{const a=l("AdminMembershipRequest",!0);return t(),_(O,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:u((()=>[n("div",Cr,[n("p",Mr,[Rr,c(" "+f(m(v)("Membership Request")),1)])]),n("div",qr,[n("div",Br,[n("div",Sr,[d(S,{class:"fr-mr-1v",user:e.request.user,rounded:!0,size:24},null,8,["user"]),c(" "+f(m(v)("{fullName} asks to join the organization.",{fullName:e.request.user.first_name+" "+e.request.user.last_name})),1)]),n("div",Vr,f(e.request.comment),1)]),e.showActions?(t(),o("div",Tr,[n("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:r[0]||(r[0]=r=>e.$emit("accept",e.request.id)),disabled:e.loading,"data-testid":"accept"},f(m(v)("Accept request")),9,Er),n("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:e.loading,"data-fr-opened":"false","aria-controls":m(p),"data-testid":"refuse"},f(m(v)("Refuse")),9,Pr),(t(),_(k,{to:"body"},[n("dialog",{"aria-labelledby":m(h),role:"dialog",id:m(p),class:"fr-modal","data-testid":"modal"},[n("div",Ir,[n("div",Or,[n("div",Hr,[n("div",$r,[n("div",Dr,[n("button",{class:"fr-btn--close fr-btn",title:m(v)("Close the modal dialog"),"aria-controls":m(p),onClick:z(x,["prevent"])},f(m(v)("Close")),9,jr)]),n("div",Nr,[n("h1",{id:m(h),class:"fr-modal__title fr-mb-2w"},f(m(v)("Refuse membership request")),9,Lr),d(a,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:e.oid,request:e.request,"show-actions":!1},null,8,["oid","request"]),n("form",{onSubmit:z(w,["prevent"]),onReset:x},[d(H,{label:m(v)("You can provide the refusal reason:"),modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=e=>g.value=e),"data-testid":"comment-group"},null,8,["label","modelValue"]),n("div",Yr,[n("div",Wr,[n("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:e.loading,"data-testid":"cancel-modal-button"},f(m(v)("Cancel")),9,Fr)]),n("div",Jr,[n("button",{class:"fr-btn",type:"submit",disabled:e.loading,"data-testid":"refuse-modal-button"},f(m(v)("Refuse request")),9,Zr)])])],32)])])])])])],8,Ur)]))])):s("",!0)])])),_:1})}}}),Kr=["aria-labelledby","id"],Qr={class:"fr-container fr-container--fluid fr-container-md"},Xr={class:"fr-grid-row fr-grid-row--center"},ea={class:"fr-col-12 fr-col-md-8"},ra={class:"fr-modal__body"},aa={class:"fr-modal__header"},la=["title","aria-controls"],ta={class:"fr-modal__content"},oa=["id"],na={class:"fr-modal__footer"},ia={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},sa=["disabled"],da=["disabled"],ua=a({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(e,{emit:r}){const a=e,l=r,{t:o}=C(),{toast:i}=I(),u=b(!1),c=b(),v=b("editor"),g=w((()=>"fr-modal-title-user-"+a.id));async function p(){try{u.value=!0,c.value&&(await D(a.oid,c.value,v.value),l("memberAdded"),y())}catch(e){i.error(o("An error occurred while update member role."))}finally{u.value=!1}}function h(e){return e.map((e=>{var r;const a={...e,avatar_thumbnail:null!==(r=e.avatar_url)&&void 0!==r?r:void 0};return{value:a.id,label:a.first_name+" "+a.last_name,image:j(a,32)}}))}function y(){u.value=!1,c.value=void 0,v.value="editor";const e=document.getElementById(a.id);globalThis.dsfr(e).modal.conceal()}return(e,r)=>(t(),_(k,{to:"body"},[n("dialog",{"aria-labelledby":g.value,role:"dialog",id:e.id,class:"fr-modal"},[n("div",Qr,[n("div",Xr,[n("div",ea,[n("div",ra,[n("div",aa,[n("button",{class:"fr-btn--close fr-btn",title:m(o)("Close the modal dialog"),"aria-controls":e.id},f(m(o)("Close")),9,la)]),n("form",{onSubmit:z(p,["prevent"])},[n("div",ta,[n("h1",{id:g.value,class:"fr-modal__title fr-mb-2w"},f(m(o)("Add member to the organization")),9,oa),d($,{placeholder:e.$t("Search a user"),searchPlaceholder:e.$t("Search a user..."),suggestUrl:"/users/suggest/",values:c.value,onChange:r[0]||(r[0]=e=>c.value=e),allOption:e.$t("Select a user"),addAllOption:!1,onSuggest:h,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),e.roles.length>0?(t(),_(E,{key:0,label:m(o)("Role of the member"),"model-value":v.value,"onUpdate:modelValue":r[1]||(r[1]=e=>v.value=e),options:e.roles},null,8,["label","model-value","options"])):s("",!0)]),n("div",na,[n("div",ia,[n("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:y,disabled:u.value},f(m(o)("Cancel")),9,sa),n("button",{class:"fr-btn",type:"submit",disabled:u.value},f(m(o)("Add to the organization")),9,da)])])],32)])])])])],8,Kr)]))}}),ca=["aria-controls"],fa=a({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(e){const r=e,{t:a}=C(),l=w((()=>"fr-modal-add-user-"+r.oid));return(e,r)=>(t(),o(g,null,[n("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":l.value},f(m(a)("Add member")),9,ca),d(ua,{id:l.value,oid:e.oid,roles:e.roles,onMemberAdded:r[0]||(r[0]=r=>e.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),ma={key:0},ba=n("li",null,null,-1),va={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},ga={class:"fr-col-12 fr-col-md"},pa={class:"fr-h1 fr-mb-2w"},_a={key:0,class:"fr-col-auto"},ha={class:"subtitle subtitle--uppercase"},ya={class:"subtitle subtitle--uppercase fr-mt-2w fr-mb-1v"},wa={class:"fr-table fr-table--layout-fixed"},ka={scope:"col"},za={scope:"col"},xa={key:0,scope:"col"},Aa={class:"fr-badge"},Ca={key:0},Ma=a({__name:"Members",props:{oid:{}},setup(e){const r=e,{t:a}=C(),{toast:i}=I(),h=b([]),k=w((()=>N||A.value.some((e=>{var r;return e.user.id===(null===(r=V)||void 0===r?void 0:r.id)&&"admin"===e.role})))),z=b([]),x={name:"SomeName"},A=b([]),M=b(!1);async function R(){const e=await F(r.oid);A.value=e.members}async function q(){const e=await L(r.oid);h.value=e}async function B(e){M.value=!0;const l=[];try{await J(r.oid,e),l.push(q()),l.push(R())}catch(t){i.error(a("An error occurred while accepting this membership."))}finally{Promise.all(l).finally((()=>M.value=!1))}}async function S(e,l){M.value=!0;const t=[];try{await Z(r.oid,e,l),t.push(q()),t.push(R())}catch(o){i.error(a("An error occurred while refusing this membership."))}finally{Promise.all(t).finally((()=>M.value=!1))}}return y((()=>{k.value&&L(r.oid).then((e=>h.value=e))})),v((()=>{Y().then(W).then((e=>z.value=e)),R()})),(e,r)=>{const i=l("router-link");return t(),o("div",null,[d(Ie,null,{default:u((()=>[n("li",null,[d(i,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(m(a)("Administration")),1)])),_:1})]),x?(t(),o("li",ma,[d(i,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(x.name),1)])),_:1})])):s("",!0),ba])),_:1}),n("div",va,[n("div",ga,[n("h1",pa,f(m(a)("Members")),1)]),k.value?(t(),o("div",_a,[d(fa,{oid:e.oid,roles:z.value,onMemberAdded:R},null,8,["oid","roles"])])):s("",!0)]),h.value.length?(t(),o(g,{key:0},[n("h2",ha,f(m(a)("{n} requests",{n:h.value.length})),1),(t(!0),o(g,null,p(h.value,(r=>(t(),_(Gr,{class:"fr-mb-4w",key:r.id,loading:M.value,oid:e.oid,request:r,"show-actions":!0,onAccept:B,onRefuse:S},null,8,["loading","oid","request"])))),128))],64)):s("",!0),n("h2",ya,f(m(a)("{n} members",{n:A.value.length})),1),n("div",wa,[n("table",null,[n("thead",null,[n("tr",null,[n("th",ka,f(m(a)("Members")),1),n("th",za,f(m(a)("Status")),1),k.value?(t(),o("th",xa,f(m(a)("Action")),1)):s("",!0)])]),n("tbody",null,[(t(!0),o(g,null,p(A.value,(r=>{return t(),o("tr",{key:r.user.id},[n("td",null,f(r.user.first_name)+" "+f(r.user.last_name),1),n("td",null,[n("p",Aa,f((a=r.role,null!==(l=null===(i=z.value.find((e=>e.value===a)))||void 0===i?void 0:i.label)&&void 0!==l?l:a)),1)]),k.value?(t(),o("td",Ca,[d(Ar,{member:r,oid:e.oid,roles:z.value,onMemberUpdated:R},null,8,["member","oid","roles"])])):s("",!0)]);var a,l,i})),128))])])])])}}}),Ra={class:"fr-container--fluid"},qa={key:0},Ba={class:"fr-breadcrumb__link","aria-current":"page"},Sa=["id"],Va=["disabled","onClick"],Ta={class:"fr-col"},Ea={class:"fr-m-0 text-grey-500"},Pa={class:"fr-m-0 fr-text--xs text-default-error"},Ua={class:"fr-col-auto"},Ia=["disabled","aria-controls"],Oa=["aria-labelledby","id"],Ha={class:"fr-container fr-container--fluid fr-container-md"},$a={class:"fr-grid-row fr-grid-row--center"},Da={class:"fr-col-12 fr-col-md-8"},ja={class:"fr-modal__body"},Na={class:"fr-modal__header"},La=["title","aria-controls"],Ya={class:"fr-modal__content"},Wa=["id"],Fa={class:"fr-text--bold"},Ja={class:"fr-modal__footer"},Za={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},Ga=["disabled"],Ka=a({__name:"Profile",props:{oid:{}},setup(e){const{t:r}=C(),{toast:a}=I(),i=e,g=G(),p=b(null),h=b(null),w=b(null),z=b([]),x=b(!1),A=M("modal"),R=M("modalTitle");function q(){w.value&&(x.value=!0,Q(w.value.id).then((()=>{g.replace("/"),window.location.reload()})).catch((()=>a.error(r("An error occured when deleting the organization.")))).finally((()=>x.value=!1)))}function S(e,l){x.value=!0,X(e).then((()=>a.success(r("Organization updated !")))).catch((()=>a.error(r("An error occured when updating the organization.")))).finally((()=>x.value=!1))}return v((async()=>p.value=await B())),y((async()=>{w.value=await F(i.oid)})),(e,a)=>{const i=l("router-link");return t(),o("div",Ra,[d(Ie,null,{default:u((()=>[n("li",null,[d(i,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(m(r)("Administration")),1)])),_:1})]),w.value?(t(),o("li",qa,[d(i,{class:"fr-breadcrumb__link",to:"/"},{default:u((()=>[c(f(w.value.name),1)])),_:1})])):s("",!0),n("li",null,[n("a",Ba,f(m(r)("Profile")),1)])])),_:1}),h.value?(t(),o("h2",{key:0,class:"subtitle subtitle--uppercase fr-mb-5v",id:h.value.legend},f(m(r)("Edit profile")),9,Sa)):s("",!0),w.value?(t(),_(K,{key:1,organization:w.value,errors:z.value,showLegend:!1,showWell:!1,ref_key:"form",ref:h,onSubmit:S},{submitButton:u((({submit:e})=>[n("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:x.value,"data-testid":"submitButton",onClick:e},f(m(r)("Save")),9,Va)])),default:u((()=>[d(tr,{class:"fr-mt-6w"},{default:u((()=>[n("div",Ta,[n("p",Ea,f(m(r)("Delete the organization")),1),n("p",Pa,f(m(r)("Be careful, this action can't be reverse.")),1)]),n("div",Ua,[n("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:x.value,"data-fr-opened":"false","aria-controls":m(A)},f(m(r)("Delete")),9,Ia),(t(),_(k,{to:"body"},[n("dialog",{"aria-labelledby":m(R),role:"dialog",id:m(A),class:"fr-modal"},[n("div",Ha,[n("div",$a,[n("div",Da,[n("div",ja,[n("div",Na,[n("button",{class:"fr-btn--close fr-btn",title:m(r)("Close the modal dialog"),"aria-controls":m(A)},f(m(r)("Close")),9,La)]),n("div",Ya,[n("h1",{id:m(R),class:"fr-modal__title fr-mb-2w"},f(m(r)("Are you sure you want to delete this organization ?")),9,Wa),n("p",Fa,f(m(r)("This action can't be reverse.")),1),n("p",null,f(m(r)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),n("p",null,f(m(r)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),n("div",Ja,[n("div",Za,[n("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:x.value,onClick:q},f(m(r)("Delete")),9,Ga)])])])])])])],8,Oa)]))])])),_:1})])),_:1},8,["organization","errors"])):s("",!0)])}}});ee({admin_root:re,default_lang:ae.global.locale.value,explorable_resources:le,only_locales:ae.global.locale.value,schema_documentation_url:te,schema_validata_url:oe,show_copy_resource_permalink:!0,title:ne});const Qa=[{path:"/me",component:ar},{path:"/organizations/:oid",children:[{path:"datasets",component:Ne,props:!0,name:"organization-datasets"},{path:"reuses",component:Ze,props:!0,name:"organization-reuses"},{path:"members",component:Ma,props:!0,name:"organization-members"},{path:"profile",component:Ka,props:!0,name:"organization-profile"}]}],Xa=ie({history:se(),routes:Qa}),el=x(Ee);de(el),el.use(ue),el.use(ce),el.use(ae),el.use(Xa),el.mount("#admin"),globalThis.dsfr.start(),console.log("JS is injected !")}}}));
